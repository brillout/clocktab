{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./views/BigText/get_max_font_size.js","webpack:///./views/BigText/index.js","webpack:///./.build/.goldpage/generated-source-code/browser-entries/views/CountdownPage/countdown.page.js.browser-entry.js","webpack:///./views/CountdownPage/set_countdown.js","webpack:///./views/CountdownPage/PRESETS.js","webpack:///./views/CountdownPage/init_countdown_options.js","webpack:///./views/CountdownPage/preset_concept_name.js","webpack:///./views/CountdownPage/onPageLoad.js","webpack:///./views/CountdownPage/CountdownView.js","webpack:///./views/CountdownPage/countdown.page.js","webpack:///./tab-utils/private/remove_hash.js","webpack:///./tab-utils/auto_remove_hash.js","webpack:///./tab-utils/TabSettings/SettingsView.js","webpack:///./tab-utils/TabSettings/load_font.js","webpack:///./tab-utils/TabSettings/load_asap.js","webpack:///./tab-utils/TabSettings/load_font_list.js","webpack:///./tab-utils/TabSettings/set_background/set_background.ts","webpack:///./tab-utils/TabSettings/PersistantInput.ts","webpack:///./tab-utils/utils/escape_html.ts","webpack:///./tab-utils/TabSettings/migrations/rename_keys_and_values.js","webpack:///./tab-utils/TabSettings/migrations/001-ancient-schema.js","webpack:///./tab-utils/TabSettings/migrations/migrate_user_presets.js","webpack:///./tab-utils/TabSettings/migrations/002-migrate-user-preset-ids-and-values.js","webpack:///./tab-utils/TabSettings/migrations/003-migrate-subapp-id.js","webpack:///./tab-utils/TabSettings/migrations/004-migrate-old-timer-tab-schema.js","webpack:///./tab-utils/TabSettings/migrations/005-migrate-to-centralized-store.ts","webpack:///./tab-utils/TabSettings/TabSettings.ts","webpack:///./tab-utils/TabSettings/run_migrations.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","22","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","dummy_el","get_max_font_size","dom_el","max_width","max_height","assert","isPositiveNumber","el","outer_width","Infinity","outer_height","DUMMY_FONT_SIZE","dummy_html","innerHTML","dummy","getDummy","tagName","dummy_text","textContent","track_error","fontSize","width","height","style","fontFamily","get_computed_style","whiteSpace","letterSpacing","lineHeight","dummy_height","get_size","dummy_width","JSON","stringify","is_rendered","ratio_width","ratio_height","ratio","Math","min","getEstimation","log_data","id","dummy_wrapper","document","createElement","pointerEvents","overflow","position","zIndex","visibility","prepend","body","styleProp","defaultView","getComputedStyle","getPropertyValue","val","constructor","Number","el_id","rendered","val__casted","parseInt","offsetParent","get_max_width","BigText","content_on_top","top_line_content","className","click-name","set_text_position","includes","layout_container","querySelector","forEach","slot","classList","on_big_text_load","containerEl","scaleEl","zoomEl","addEventListener","refresh_big_text_size","passive","make_element_zoomable","set_bottom_line","bottom_text","bot_el","getElementById","set_max_width_getter","_get_max_width","top_el","innerWidth","innerHeight","container_width","middle_table","padding","layout_top_content","layout_top_content_height","width_limit","max","compute_max_size","top_line_sizes","bot_line_sizes","compute_font_sizes","ret","browserConfig","require","initFunctions","pageConfig","get_option_value","start_countdown","_get_option_value","pulse","dom_beat","setTimeout","top_text","center_text","countdown_date","Date","countdown_title","replace","toLocaleDateString","time_left__miliseconds","rest","seconds","minutes","hours","days","months","time_major","time_minor","filter","suffix","suffix_long","format","title","update_tab_title","new_year","getFullYear","toString","us_election","PRESETS","trump_wins_2020","countdown_size","countdown_position","countdown_background_color","countdown_background_image","countdown_font","countdown_shadow","countdown_color","trump_loses_2020","christmas","init_clock_options","text_container","tab_settings","TabSettings","option_spec_list","option_id","option_type","option_default","option_description","getNextDay","is_creator_option","option_choices","option_placeholder","preset_spec_list","on_any_change","is_initial_run","update_options","on_font_change","no_random_preset","enable_import_export","subapp_id","preset_concept_name","font_loaded_promise","generate_dom","color","textShadow","setHours","onPageLoad","load_common","init_countdown_options","Promise","race","sleep","CountdownView","Counter","SettingsView","config","route","view","remove_hash","history","pushState","location","pathname","search","auto_remove_hash","IGNORE_LIST","INCLUDE_LIST","check","hash","isEmptyHash","timeout","capture","href","endsWith","load_font","head","font_name","do_it","WebFont","load","get_font_spec","fontactive","resolve","fontinactive","attempts","pow","promise","custom","families","urls","google","load_font_list","resolve_promise","resp","error","console","message","font_list","map","f","family","sort","url","onsuccess","getElementsByTagName","do_","script","src","onerror","removeChild","onload","appendChild","load_asap","BG_EL","bg_container_selector_","gen","reject","_next","_throw","arg","info","done","then","fn","self","this","args","arguments","err","undefined","_set_background","regeneratorRuntime","mark","_callee","color_code","image_uri","bg_container_selector","is_outdated","bg_img_val","wrap","_context","prev","next","get_is_outdated","load_image","sent","abrupt","stop","show_loader","backgroundColor","apply_color","backgroundImage","apply_image","_x4","_x5","_load_image","_callee2","imgEl","loaded","on_load","on_error","set_loader_indicator","_context2","alert","w","h","test","image_val","bg_container","bg_container_","el1","el2","backgroundSize","call_number","current","_objectWithoutProperties","source","excluded","target","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_typeof","obj","iterator","_possibleConstructorReturn","ReferenceError","_assertThisInitialized","_get","receiver","Reflect","base","_getPrototypeOf","_superPropBase","desc","getOwnPropertyDescriptor","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","TypeError","writable","configurable","_setPrototypeOf","enumerableOnly","symbols","sym","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","_classPrivateFieldLooseBase","privateKey","_classPrivateFieldLooseKey","PersistantInput","_props","_input_id","_on_input_change","_input_default","_storage_key","input_tag","input_type","_dom_el","_input_el","input_id","on_input_change","input_default","_input_retriever","store","has_val","get_val","set_val","set_stored_value","_input_modifier","_this","_generate_input","_ref3","input_description","input_width","input_container","description_el","input_el","setAttribute","generate_input","getOwnPropertyDescriptors","defineProperties","_init_dom","init_val","has_stored_value","get_stored_value","_change_event","hide_show_el","BooleanInput","_PersistantInput","_this2","checked","removeAttribute","TextInput","_PersistantInput2","_this3","input_placeholder","placeholder","_PersistantInput3","SelectInput","_ref","_this4","input_options","text","divider_html","_this5","option_arg","_generate_option_html","new_options","_this6","current_value","current_option_values","Array","from","_parse_option_arg","get_divider","_this$_parse_option_a","val_pretty","String","_PersistantInput4","DateInput","_getPrototypeOf2","_this7","_len","_key","concat","enableTime","ColorInput","_PersistantInput5","_this8","Button","_ref2","on_click","_ref2$className","_this9","onclick","ev","preventDefault","to_hide","rename_keys_and_values","key_replacements","value_replacements","db","has_changes","entries","localStorage","clear","migrate_ancient_schema","theme","bg_image","bg_color","font_shadow","color_font","font_size","clock_theme","random","migrate_user_presets","migrator","presets__storage_key","presets__string","presets","parse","preset","presets__string__updated","migrate_user_preset_ids_and_values","preset_name","preset_id","preset_options","preset_values","migrate_subapp_id","app_name","migrate_old_timer_tab_schema","bg_url","goto_url","arr","isArray","_arr","_n","_d","_e","_s","_i","migrate_to_centralized_store","startsWith","removeItem","migrate__rename_keys","_toConsumableArray","arr2","_arrayWithoutHoles","iter","_iterableToArray","_nonIterableSpread","schema_version","migrators","schema_version__curent","get_schema_version","getTime","set_schema_version","run_migrations","_ref$text_container","_ref$no_random_preset","_ref$on_font_change","creator_content","options_content","options_container","save_content","save_container","share_content","share_container","preset_list","option_list","resolve_font_loaded_promise","button_mod","button_del","name_option","button_url","_global_side_effects__timeout","_previous_link","_link_el","_font_list_already_loading","_ref11","hasTextFontInput","find","hasTextShadowInput","hasTextColorInput","_ref4","_ref12","option_spec","TextColorOption","TextShadowOption","BackgroundImageOption","BackgroundColorOption","ChoiceOption","_load_font_list2","_update_font","opt","generate_import_export_dom","global_side_effects","btn","modify_preset","_btn","delete_preset","_btn2","save_created_preset","preset_selected","is_creator_preset","input_value","from_name_to_id","get_preset_by_name","can_be_null","error_msg","option","preset_val","new_preset","SavedPreset","save_preset","select_preset","reset_creator","reset","active_preset","is_real_preset","_loop","opt_id","opt_val","find_option","set_input_value","select_preset_creator","new_preset_id","generate_unique_preset_id_copy","copy_to_creator","from_id_to_name","is_saved_preset","remove_preset","_ref5","_ref5$is_initial_run","run_side_effects","requestAnimationFrame","update_background","update_font","update_option_visibility","update_button_visibility","update_share_link","update_save_block","load_preset_from_url","track_user_presets","set_options_container_visibility","every","Boolean","is_preset_selector","display","toLowerCase","remove","current_link","share_link","add","preset_url","preset_data","from_url","preset_conflict","show_toast","image","current_backgroud_image","_x","_x2","_x3","current_backgroud_color","get_font_name","current_font_name","load_text_font","dep_option_id","option_dependency","hide","show","is_randomizer_preset","t0","font_option","t1","t2","t3","t4","t5","add_fonts","match","creator_preset","active_value","is_background_image_option","background_image_option","is_background_color_option","background_color_option","is_font_option","random_preset","set","preset_thing","FakePreset","preset_option","default_preset_id","Option","_ref6","_ref6$is_creator_opti","input_args","user_input","assign","before_dom","init","input_set","input_get","get_preset_value","preset_value","_Option","DateOption","_Option2","BooleanOption","_this10","_Option3","SelectOption","_this11","add_options","_SelectOption","_ref7","_Option4","TextOption","_this12","_Option5","ColorOption","_this13","_ColorOption","_TextOption","_SelectOption2","PresetOption","_ref8","_this14","get_input_options","refresh","_this$tab_settings$pr","presets_ordered","special_ones","saved_ones","native_ones","_ref9","_TextOption2","_this15","_ColorOption2","_getPrototypeOf3","_this16","_len2","_key2","_SelectOption3","FontOption","_ref10","_this17","input_optoins","get_all_preset_fonts","_load_text_font","_callee3","_ref21","_context3","PresetList","_ref13","_preset_savior","_native_presets","randomizer_preset","CreatorPreset","_ref14","_ref15","refresh_user_input","get_saved_presets","_ref16","_ref17","_ref17$can_be_null","_get_all_presets","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","_this$presets_ordered","preset_font_names","preset_font_name","Set","preset_ids","_get_all_preset_ids","white_space_seralized","split","join","_i2","candidate","_this$presets_ordered2","_this$presets_ordered3","_get_saved_presets","PresetSerializer","preset_string","Preset","_ref18","prettified","_Preset","_getPrototypeOf4","_this18","_len3","_key3","_generated_link","to_url","_Preset2","NativePreset","_this19","PresetData","PresetValues","PresetSavior","_ref19","_subapp_id","_get_presets","a","warning","_save_presets","old_length","new_length","_FakePreset","RandomizerPreset","_ref20","_this20","_picked","random_candidates","floor","pick_random_preset","_FakePreset2","_getPrototypeOf5","_this21","_len4","_key4","NameIdConverter","sep_regex","word","toUpperCase","LinkSerializer","str","str__base64","btoa","atob","serialize_preset","preset_base64","_to_base64","url_base","name_encoded","encodeURIComponent","pipe_data","_from_base64","deserialize_preset","is_error","log"],"mappings":"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","file":"views/CountdownPage/countdown.page.js.hash_082d6339f88586d1836f.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t22: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([491,1,4,0,2]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import assert from \"@brillout/assert\";\nimport { track_error } from \"../../tab-utils/views/common/tracker\";\nimport { get_browser_info } from \"../../tab-utils/utils/get_browser_info\";\n\nexport { get_max_font_size };\nexport { isPositiveNumber };\nexport { get_size };\n\n/*/\nconst DEBUG = true;\n/*/\nconst DEBUG = false;\n//*/\n\nfunction get_max_font_size({ dom_el, max_width, max_height }) {\n  assert(\n    dom_el && isPositiveNumber(max_width) && isPositiveNumber(max_height),\n    { max_width, max_height, dom_el }\n  );\n  const { fontSize, height, width } = getEstimation(\n    dom_el,\n    max_width,\n    max_height\n  );\n\n  const log_data = {\n    dom_el: dom_el.id,\n    height,\n    width,\n    max_height,\n    max_width,\n    fontSize,\n  };\n\n  const approximation = 1.02;\n  assert(\n    isPositiveNumber(fontSize) &&\n      isPositiveNumber(height) &&\n      isPositiveNumber(width) &&\n      height <= max_height * approximation &&\n      width <= max_width * approximation,\n    log_data\n  );\n\n  DEBUG && assert.log(\"[max-font-size-computation]\", log_data);\n\n  return { fontSize, height, width, max_height, max_width };\n}\n\nfunction getEstimation(el, outer_width = Infinity, outer_height = Infinity) {\n  assert(outer_height >= 0 && outer_width >= 0, { outer_height, outer_width });\n\n  const DUMMY_FONT_SIZE = 100; //intuitively: the bigger the font-size the more precise the approximation\n\n  let dummy_html = el.innerHTML;\n  if (dummy_html.length < 1) dummy_html = \"y\";\n\n  var dummy = getDummy(el.tagName);\n  dummy.innerHTML = dummy_html;\n  const dummy_text = dummy.textContent;\n\n  if (dummy_text === \"\") {\n    track_error({\n      name: \"[known_unexpected][get_max_font_size]empty_dummy\",\n      value: dummy_html,\n    });\n    return {\n      fontSize: 0,\n      width: 0,\n      height: 0,\n    };\n  }\n\n  dummy.style.fontFamily = get_computed_style(el, \"font-family\");\n  dummy.style.fontSize = DUMMY_FONT_SIZE + \"px\";\n  dummy.style.whiteSpace = \"nowrap\"; //should el be equal to get_computed_style('white-space')?\n  dummy.style.letterSpacing = get_computed_style(el, \"letter-spacing\");\n  dummy.style.lineHeight = get_computed_style(el, \"line-height\");\n\n  const dummy_height = get_size(dummy, \"height\");\n  const dummy_width = get_size(dummy, \"width\");\n\n  assert(dummy_text.length > 0);\n  assert(isPositiveNumber(dummy_width) && isPositiveNumber(dummy_height), {\n    dummy_width,\n    dummy_height,\n    dummy_html,\n  });\n\n  if (dummy_height === 0 || dummy_width === 0) {\n    if (dummy_height !== 0 || dummy_width !== 0) {\n      track_error({\n        name: \"unexpected dummy size\",\n        value: JSON.stringify({ dummy_height, dummy_width, dummy_text }),\n      });\n    } else if (is_rendered(dummy)) {\n      track_error({\n        name: \"unexpected zero-sized rendered dummy\",\n        value: \"dummy_text == \" + dummy_text,\n      });\n    }\n\n    return {\n      fontSize: 0,\n      width: 0,\n      height: 0,\n    };\n  }\n\n  assert(dummy_height > 0 && dummy_width > 0);\n\n  const ratio_width = outer_width / dummy_width;\n  const ratio_height = outer_height / dummy_height;\n  const ratio = Math.min(ratio_width, ratio_height);\n\n  const fontSize = ratio * DUMMY_FONT_SIZE;\n  const width = ratio * dummy_width;\n  const height = ratio * dummy_height;\n\n  assert(\n    isPositiveNumber(fontSize) &&\n      isPositiveNumber(height) &&\n      isPositiveNumber(width),\n    {\n      fontSize,\n      width,\n      height,\n      dummy_width,\n      dummy_height,\n      outer_width,\n      outer_height,\n    }\n  );\n\n  return {\n    fontSize,\n    width,\n    height,\n  };\n}\n\nlet dummy_el;\nfunction getDummy(tagName) {\n  if (!dummy_el) {\n    // Create a wrapper to ensure that dummy is not cropped by a `overflow: hidden` ancestor\n    // See https://css-tricks.com/popping-hidden-overflow/\n    const dummy_wrapper = document.createElement(\"div\");\n    dummy_wrapper.pointerEvents = \"none\";\n    dummy_wrapper.style.overflow = \"hidden\";\n    dummy_wrapper.style.height = \"1px\";\n    dummy_wrapper.style.width = \"1px\";\n    dummy_wrapper.style.position = \"absolute\";\n    dummy_wrapper.style.zIndex = \"999999999\";\n    dummy_wrapper.visibility = \"hidden\";\n\n    dummy_el = document.createElement(tagName);\n    dummy_el.style.position = \"absolute\";\n\n    dummy_wrapper.prepend(dummy_el);\n    document.body.prepend(dummy_wrapper);\n  }\n  assert(dummy_el.tagName === tagName);\n  return dummy_el;\n}\n\nfunction get_computed_style(el, styleProp) {\n  return document.defaultView.getComputedStyle(el).getPropertyValue(styleProp);\n}\n\nfunction isPositiveNumber(val) {\n  // `return val>=0;` doesn't catch `val===null`\n  assert(null >= 0);\n\n  return (\n    val !== null &&\n    (val === 0 || (val && val.constructor === Number && val > 0))\n  );\n}\n\nfunction get_size(el, styleProp) {\n  assert(el, \"[get_size][error]\", { styleProp, el });\n\n  const el_id = el.id;\n\n  const rendered = is_rendered(el);\n  const val = get_computed_style(el, styleProp);\n\n  if (!val) {\n    if (rendered) {\n      track_error({\n        name: \"unexpected computed style\",\n        value: \"val == \" + val,\n      });\n    }\n    return 0;\n  }\n\n  const val__casted = parseInt(val, 10);\n\n  if (!val__casted && val__casted !== 0) {\n    if (rendered) {\n      track_error({\n        name: \"unexpected computed style value\",\n        value: \"val == \" + val,\n      });\n    }\n    return 0;\n  }\n\n  assert(isPositiveNumber(val__casted), \"[get_size][error]\", {\n    el_id,\n    styleProp,\n    val,\n    val__casted,\n  });\n\n  return val__casted;\n}\n\nfunction is_rendered(el) {\n  // https://stackoverflow.com/questions/19669786/check-if-element-is-visible-in-dom/21696585#21696585\n  return el.offsetParent !== null;\n}\n","import \"./big_text.css\";\nimport React from \"react\";\nimport {\n  get_max_font_size,\n  isPositiveNumber,\n  get_size,\n} from \"./get_max_font_size\";\nimport assert from \"@brillout/assert\";\nimport { make_element_zoomable } from \"../../tab-utils/make_element_zoomable\";\n\nexport default BigText;\nexport { on_big_text_load };\nexport { refresh_big_text_size };\nexport { set_bottom_line };\nexport { set_max_width_getter };\nexport { set_text_position };\n\nfunction BigText({ content_on_top, top_line_content, id }) {\n  return (\n    <div id=\"bt-zoom-container\" style={{ width: \"100%\" }}>\n      <div id=\"bt-layout-container\" className=\"bt-position-center\">\n        <div id=\"bt-layout-top\">\n          <div id=\"bt-layout-top-content\">{content_on_top}</div>\n        </div>\n\n        <div id={id} className=\"bt-layout-middle\">\n          <table id=\"bt-middle-table\" click-name=\"big-zoomable-text\">\n            <tr>\n              <td id=\"bt-top-line\">{top_line_content}</td>\n            </tr>\n            <tr>\n              <td id=\"bt-bot-line\"></td>\n            </tr>\n          </table>\n        </div>\n\n        <div id=\"bt-layout-bottom\"></div>\n      </div>\n    </div>\n  );\n}\n\nfunction set_text_position(position) {\n  assert(\n    [\n      \"top-left\",\n      \"top\",\n      \"top-right\",\n      \"center-left\",\n      \"center\",\n      \"center-right\",\n      \"bottom-left\",\n      \"bottom\",\n      \"bottom-right\",\n    ].includes(position),\n    { position }\n  );\n  const layout_container = document.querySelector(\"#bt-layout-container\");\n  [\"top\", \"center\", \"bottom\", \"right\", \"left\"].forEach((slot) => {\n    layout_container.classList[position.includes(slot) ? \"add\" : \"remove\"](\n      \"bt-position-\" + slot\n    );\n  });\n}\n\nfunction on_big_text_load() {\n  activate_auto_resize();\n  activate_zoom();\n}\n\nfunction set_bottom_line(bottom_text) {\n  const bot_el = document.getElementById(\"bt-bot-line\");\n  assert(bot_el);\n  bot_el.innerHTML = bottom_text;\n}\n\nlet get_max_width;\nfunction set_max_width_getter(_get_max_width) {\n  get_max_width = _get_max_width;\n}\n\nfunction activate_auto_resize() {\n  window.addEventListener(\"resize\", refresh_big_text_size, { passive: true });\n}\n\nfunction activate_zoom() {\n  const containerEl = document.querySelector(\"#bt-zoom-container\");\n  const scaleEl = document.querySelector(\"#bt-layout-container\");\n  const zoomEl = document.querySelector(\"#bt-middle-table\");\n  assert(containerEl && scaleEl && zoomEl);\n  make_element_zoomable({ containerEl, scaleEl, zoomEl });\n}\n\n/*/\nconst DEBUG = true;\n/*/\nconst DEBUG = false;\n//*/\n\nfunction refresh_big_text_size() {\n  const bot_el = document.getElementById(\"bt-bot-line\");\n  const top_el = document.getElementById(\"bt-top-line\");\n  assert(bot_el && top_el, \"Missing bottom/top line\", { bot_el, top_el });\n\n  const { max_height, max_width } = compute_max_size();\n  DEBUG &&\n    console.log(\"[size-computation]\", bot_el, top_el, {\n      \"window.innerHeight\": window.innerHeight,\n      \"window.innerWidth\": window.innerWidth,\n      max_width,\n      max_height,\n    });\n\n  const { bot_line_sizes, top_line_sizes } = compute_font_sizes({\n    max_height,\n    max_width,\n    top_el,\n    bot_el,\n  });\n  DEBUG && assert.log(\"[size-computation]\", { top_line_sizes, bot_line_sizes });\n\n  assert(\n    isPositiveNumber(top_line_sizes.fontSize) &&\n      (!bot_line_sizes || isPositiveNumber(bot_line_sizes.fontSize)),\n    { top_line_sizes, bot_line_sizes }\n  );\n\n  if (bot_line_sizes) {\n    bot_el.style.fontSize = bot_line_sizes.fontSize + \"px\";\n  }\n  top_el.style.fontSize = top_line_sizes.fontSize + \"px\";\n}\n\nfunction compute_max_size() {\n  let max_width = window.innerWidth;\n  let max_height = window.innerHeight;\n  assert(\n    isPositiveNumber(max_width) && isPositiveNumber(max_height),\n    \"unexpected window sizes\",\n    {\n      max_width,\n      max_height,\n    }\n  );\n\n  // Substract width of side bar\n  {\n    const containerEl = document.querySelector(\"#bt-zoom-container\");\n    const container_width = get_size(containerEl, \"width\");\n    assert(isPositiveNumber(container_width), \"unexpected container width\", {\n      container_width,\n    });\n    max_width = Math.min(max_width, container_width);\n  }\n\n  {\n    // Remove padding\n    const middle_table = document.getElementById(\"bt-middle-table\");\n    const padding = {\n      width:\n        get_size(middle_table, \"padding-left\") +\n        get_size(middle_table, \"padding-right\"),\n      height:\n        get_size(middle_table, \"padding-top\") +\n        get_size(middle_table, \"padding-bottom\"),\n    };\n\n    max_width = max_width - padding.width;\n    max_height = max_height - padding.height;\n  }\n\n  // Make space space for top content (advertisements)\n  {\n    const layout_top_content = document.getElementById(\"bt-layout-top-content\");\n    let layout_top_content_height = 0;\n    // Some users have no `layout_top_content`, probably because of some Ad Blocker\n    if (layout_top_content) {\n      layout_top_content_height = get_size(layout_top_content, \"height\");\n    }\n    max_height -= layout_top_content_height;\n  }\n\n  {\n    // User can control max width\n    const width_limit = parseInt(get_max_width(), 10) || Infinity;\n    assert(isPositiveNumber(width_limit), { width_limit });\n    max_width = Math.min(max_width, width_limit);\n  }\n\n  {\n    // Avoid ugly long vertical big block\n    max_height = Math.min(max_height, max_width * 1.6);\n  }\n\n  {\n    // Negative values break computation down the line\n    max_height = Math.max(max_height, 0);\n    max_width = Math.max(max_width, 0);\n  }\n\n  assert(isPositiveNumber(max_width) && isPositiveNumber(max_height), {\n    max_height,\n    max_width,\n  });\n  return { max_width, max_height };\n}\n\nfunction compute_font_sizes({ bot_el, top_el, max_height, max_width }) {\n  let top_line_sizes;\n  let bot_line_sizes;\n\n  top_line_sizes = get_max_font_size({\n    dom_el: top_el,\n    max_width,\n    max_height,\n  });\n\n  if (bot_el.innerHTML != \"\") {\n    const bottom_line_width_reducer = 0.95;\n\n    bot_line_sizes = get_max_font_size({\n      dom_el: bot_el,\n      max_width: top_line_sizes.width * bottom_line_width_reducer,\n      max_height,\n    });\n\n    const too_big = top_line_sizes.height + bot_line_sizes.height > max_height;\n    if (too_big) {\n      const resolve_ratio = 1 / 3;\n\n      top_line_sizes = get_max_font_size({\n        dom_el: top_el,\n        max_width,\n        max_height: max_height * (1 - resolve_ratio),\n      });\n\n      bot_line_sizes = get_max_font_size({\n        dom_el: bot_el,\n        max_width: top_line_sizes.width * bottom_line_width_reducer,\n        max_height: max_height * resolve_ratio,\n      });\n\n      top_line_sizes = get_max_font_size({\n        dom_el: top_el,\n        max_width,\n        max_height: max_height - bot_line_sizes.height,\n      });\n    }\n  }\n\n  return { bot_line_sizes, top_line_sizes };\n}\n","const browserConfig = require('/home/romu/code/clocktab/node_modules/@brillout/browser-config/index.js');\n\nbrowserConfig.initFunctions = {};\n\nbrowserConfig.initFunctions = browserConfig.initFunctions || {};\nbrowserConfig.initFunctions['hydratePage'] = (() => {const ret = require('/home/romu/code/clocktab/node_modules/@goldpage/browser/hydratePage.js'); return (ret||{}).__esModule===true ? ret.default : ret;})();;\n\nbrowserConfig.pageConfig = (() => {const ret = require('/home/romu/code/clocktab/views/CountdownPage/countdown.page.js'); return (ret||{}).__esModule===true ? ret.default : ret;})();;\n\nbrowserConfig['router'] = (() => {const ret = require('/home/romu/code/clocktab/node_modules/@goldpage/path-to-regexp/router.js'); return (ret||{}).__esModule===true ? ret.default : ret;})();;\n\nbrowserConfig['renderPageToDom'] = (() => {const ret = require('/home/romu/code/clocktab/node_modules/@goldpage/html/renderPageToDom.js'); return (ret||{}).__esModule===true ? ret.default : ret;})();;\n\nbrowserConfig['domRender'] = (() => {const ret = require('/home/romu/code/clocktab/tab-utils/_render/browser/domRender.js'); return (ret||{}).__esModule===true ? ret.default : ret;})();;\n\n(() => {const ret = require('/home/romu/code/clocktab/node_modules/@goldpage/browser/browserInit.js'); return (ret||{}).__esModule===true ? ret.default : ret;})();;\n","import { refresh_big_text_size, set_bottom_line } from \"../BigText\";\n\nexport { start_countdown };\nexport { dom_beat };\n\nlet get_option_value;\nfunction start_countdown({ get_option_value: _get_option_value }) {\n  get_option_value = _get_option_value;\n  ignite_beat();\n}\n\nfunction dom_beat() {\n  const top_text = document.querySelector(\"#top-text\");\n  const center_text = document.querySelector(\"#center-text\");\n\n  const countdown_date = new Date(get_option_value(\"countdown_date\"));\n\n  let countdown_title = get_option_value(\"countdown_title\");\n  countdown_title = countdown_title.replace(\n    \"%date\",\n    new Date().toLocaleDateString()\n  );\n\n  const now = new Date();\n  const { time_major, time_minor } = format(countdown_date - now);\n\n  update_tab_title({ time_major, countdown_title });\n\n  center_text.textContent = time_major;\n  top_text.textContent = countdown_title;\n  set_bottom_line(time_minor);\n  refresh_big_text_size();\n}\n\nfunction update_tab_title({ time_major, countdown_title }) {\n  let title = time_major;\n  if (countdown_title) {\n    title += \" - \" + countdown_title + \" - Countdown\";\n  }\n  document.title = title;\n}\n\nfunction format(time_left__miliseconds) {\n  let rest = time_left__miliseconds;\n\n  const milliseconds = rest % 1000;\n  rest = (rest / 1000) | 0;\n\n  const seconds = pad(rest % 60);\n  rest = (rest / 60) | 0;\n\n  const minutes = rest % 60;\n  rest = (rest / 60) | 0;\n\n  const hours = rest % 24;\n  rest = (rest / 24) | 0;\n\n  const days = rest % 30;\n  rest = (rest / 30) | 0;\n\n  const months = rest % 12;\n  rest = (rest / 12) | 0;\n\n  const years = rest;\n\n  /*\n  const decades = rest;\n\n  const centuries = rest;\n\n  const centuries = rest;\n\n  const millennia\n  */\n\n  let time_major = \"\";\n  let time_minor = \"\";\n  [\n    [years, \"y\", \"year\"],\n    [months, \"mo\", \"month\"],\n    [days, \"d\", \"day\"],\n    [hours, \"h\", \"hour\"],\n    [minutes, \"m\", \"minute\"],\n    [seconds, \"s\", \"\"],\n    // [milliseconds, 'ms'],\n  ]\n    .filter(([val]) => val)\n    .forEach(([val, suffix, suffix_long], key) => {\n      if (key === 0) {\n        time_major = val;\n        if (suffix_long) {\n          time_major += \" \" + suffix_long + (val != 1 ? \"s\" : \"\");\n        }\n        return;\n      }\n\n      if (time_minor) time_minor += \" \";\n      time_minor += val + suffix;\n    });\n\n  return { time_major, time_minor };\n}\n\nfunction pad(i) {\n  return (0 <= i && i <= 9 ? \"0\" : \"\") + i;\n}\n\nfunction ignite_beat(pulse) {\n  pulse();\n\n  function pulse() {\n    dom_beat();\n    setTimeout(pulse, 1001);\n  }\n}\n","const new_year = new Date(\n  (new Date(new Date() - 8 * 60 * 60 * 1000).getFullYear() + 1).toString()\n);\nconst us_election = new Date(\"November 3, 2020\");\nconst christmas = new Date(\"December 25, \" + new Date().getFullYear());\n\nconst PRESETS = {\n  trump_wins_2020: {\n    countdown_size: \"380\",\n    countdown_title: \"Trump Wins\",\n    countdown_date: us_election,\n    countdown_position: \"bottom\",\n    countdown_background_color: \"\",\n    countdown_background_image: \"https://i.imgur.com/BpA8fWK.png\",\n    countdown_font: \"Roboto\",\n    countdown_shadow: \"1px 1px black\",\n    /// red: #e00014\n    countdown_color: \"#0300ff\",\n  },\n  trump_loses_2020: {\n    countdown_size: \"380\",\n    countdown_title: \"End of Trump\",\n    countdown_date: us_election,\n    countdown_position: \"bottom\",\n    countdown_background_color: \"\",\n    // Non-resized: https://i.imgur.com/srnUbAP.jpg\n    countdown_background_image: \"https://i.imgur.com/srnUbAPh.jpg\",\n    countdown_font: \"Roboto\",\n    countdown_shadow: \"1px 1px black\",\n    countdown_color: \"white\",\n  },\n\n  new_year: {\n    countdown_size: \"580\",\n    countdown_title: \"2021\",\n    countdown_date: new_year,\n    countdown_position: \"center\",\n    countdown_background_color: \"\",\n    countdown_background_image: \"https://i.imgur.com/H4ZC3pZ.jpg\",\n    countdown_font: \"Roboto\",\n    countdown_shadow: \"0 1px 1px #000000\",\n    countdown_color: \"#e9e9e9\",\n  },\n\n  // Christmas backgrounds\n  // - https://imgur.com/a/LDcQh1l\n  // - https://imgur.com/a/0BZ9N2b\n  // - https://imgur.com/a/72JS8Jn\n  christmas: {\n    countdown_size: \"380\",\n    countdown_title: \"Christmas\",\n    countdown_date: christmas,\n    countdown_position: \"top\",\n    countdown_background_color: \"\",\n    countdown_background_image: \"https://i.imgur.com/Px80XKC.jpg\",\n    countdown_font: \"Roboto\",\n    countdown_shadow: \"0 2px 2px black\",\n    countdown_color: \"#f1f1f1\",\n  },\n};\n\nexport default PRESETS;\n","import { refresh_big_text_size } from \"../BigText\";\nimport { TabSettings } from \"../../tab-utils/TabSettings\";\nimport { dom_beat } from \"./set_countdown\";\nimport PRESETS from \"./PRESETS\";\nimport { set_text_position } from \"../BigText\";\nimport { preset_concept_name } from \"./preset_concept_name\";\n\nexport default init_clock_options;\n\nfunction init_clock_options() {\n  const text_container = document.getElementById(\"countdown-container\");\n\n  const tab_settings = new TabSettings({\n    option_spec_list: get_option_list(),\n    preset_spec_list: PRESETS,\n    text_container,\n    on_any_change,\n    on_font_change,\n    no_random_preset: true,\n    enable_import_export: true,\n    subapp_id: \"countdown\",\n    preset_concept_name,\n  });\n\n  const get_option_value = tab_settings.get_option_value.bind(tab_settings);\n  const { font_loaded_promise } = tab_settings;\n\n  tab_settings.generate_dom();\n\n  return { get_option_value, font_loaded_promise };\n\n  function on_font_change() {\n    refresh_big_text_size();\n  }\n  function on_any_change({ is_initial_run }) {\n    update_options();\n    if (!is_initial_run) {\n      dom_beat();\n      refresh_big_text_size();\n    }\n  }\n\n  function update_options() {\n    text_container.style.color = get_option_value(\"countdown_color\");\n    text_container.style.textShadow = get_option_value(\"countdown_shadow\");\n    set_text_position(get_option_value(\"countdown_position\"));\n  }\n}\n\nfunction get_option_list() {\n  return [\n    {\n      option_id: \"countdown_preset\",\n      option_type: \"preset-input\",\n      // option_description: preset_concept_name,\n      option_default: \"christmas\",\n    },\n    {\n      option_id: \"countdown_date\",\n      option_type: \"date-input\",\n      option_description: \"Date\",\n      option_default: getNextDay(),\n      is_creator_option: true,\n    },\n    {\n      option_id: \"countdown_title\",\n      option_type: \"text-input\",\n      option_description: \"Title\",\n      option_default: \"Until %date\",\n      is_creator_option: true,\n    },\n\n    {\n      option_id: \"countdown_position\",\n      option_type: \"choice-input\",\n      option_choices: [\n        \"top-left\",\n        \"top\",\n        \"top-right\",\n        \"center-left\",\n        \"center\",\n        \"center-right\",\n        \"bottom-left\",\n        \"bottom\",\n        \"bottom-right\",\n      ],\n      option_description: \"Countdown position\",\n      option_default: \"bottom\",\n      is_creator_option: true,\n    },\n\n    {\n      option_id: \"countdown_font\",\n      option_type: \"text-font-input\",\n      option_description: \"Font\",\n      option_default: \"Roboto\",\n      is_creator_option: true,\n    },\n    {\n      option_id: \"countdown_color\",\n      option_type: \"text-color-input\",\n      option_description: \"Font color\",\n      option_default: \"#2c2c2c\",\n      is_creator_option: true,\n    },\n    {\n      option_id: \"countdown_shadow\",\n      option_type: \"text-shadow-input\",\n      option_description: \"Font shadow\",\n      option_default: \"\",\n      option_placeholder: \"see css text-shadow\",\n      is_creator_option: true,\n    },\n    {\n      option_id: \"countdown_size\",\n      option_type: \"text-input\",\n      option_description: \"Countdown size\",\n      option_default: \"380\",\n      is_creator_option: true,\n    },\n    {\n      option_id: \"countdown_background_color\",\n      option_type: \"background-color-input\",\n      option_description: \"Background color\",\n      option_default: \"#ffffff\",\n      is_creator_option: true,\n    },\n    {\n      option_id: \"countdown_background_image\",\n      option_type: \"background-image-input\",\n      option_description: \"Background image\",\n      option_default: \"\",\n      option_placeholder: \"image url\",\n      is_creator_option: true,\n    },\n  ];\n}\n\nfunction getNextDay() {\n  const d = new Date(new Date() /* + 60*1000*/);\n  d.setHours(24, 0, 0, 0);\n  return d;\n}\n","const preset_concept_name = \"Countdown\";\nexport { preset_concept_name };\n","import { sleep } from \"../../tab-utils/sleep\";\nimport { on_big_text_load, set_max_width_getter } from \"../BigText\";\nimport init_countdown_options from \"./init_countdown_options\";\nimport { start_countdown } from \"./set_countdown\";\n\nexport default onPageLoad;\n\nasync function onPageLoad(load_common) {\n  const { get_option_value, font_loaded_promise } = init_countdown_options();\n\n  set_max_width_getter(() => get_option_value(\"countdown_size\"));\n\n  start_countdown({ get_option_value });\n\n  on_big_text_load();\n\n  await Promise.race([font_loaded_promise, sleep({ seconds: 0.4 })]);\n\n  load_common();\n}\n","import \"./countdown.css\";\nimport React from \"react\";\nimport {\n  FullViewLayout,\n  FullView,\n  MorePanel,\n  RightSide,\n} from \"../../tab-utils/views/FullViewWrapper\";\nimport BigText from \"../BigText\";\n//import News from \"../News\";\nimport { SettingsView } from \"../../tab-utils/TabSettings/SettingsView\";\nimport { preset_concept_name } from \"./preset_concept_name\";\n\nexport default CountdownView;\n\nfunction CountdownView() {\n  return (\n    <FullViewLayout>\n      <RightSide>\n        <FullView>\n          <BigText\n            id={\"countdown-container\"}\n            content_on_top={null}\n            top_line_content={<Counter />}\n          />\n        </FullView>\n\n        <MorePanel>\n          <SettingsView preset_concept_name={preset_concept_name} />\n          {/* <News preset_concept_name={preset_concept_name} /> */}\n        </MorePanel>\n      </RightSide>\n    </FullViewLayout>\n  );\n}\n\nfunction Counter() {\n  return (\n    <div>\n      <div id=\"top-text\" />\n      <div id=\"center-text\" />\n    </div>\n  );\n}\n","import {\n  FullView,\n  MorePanel,\n  config,\n} from \"../../tab-utils/views/FullViewWrapper\";\nimport onPageLoad from \"./onPageLoad\";\nimport CountdownView from \"./CountdownView\";\n\nexport default config({\n  route: \"/countdown\",\n  title: \"Countdown\",\n  view: CountdownView,\n  onPageLoad,\n});\n","export default remove_hash;\n\nfunction remove_hash() {\n  // `window.location.hash = '';` doesn't remove leading `#` sign.\n  // See https://stackoverflow.com/questions/1397329/how-to-remove-the-hash-from-window-location-url-with-javascript-without-page-r\n  window.history.pushState(\n    \"\",\n    document.title,\n    window.location.pathname + window.location.search\n  );\n}\n","import remove_hash from \"./private/remove_hash\";\n\nexport default auto_remove_hash;\n\nexport { remove_hash };\n\nfunction auto_remove_hash({ IGNORE_LIST, INCLUDE_LIST } = {}) {\n  check();\n  [100, 300, 600, 900].forEach((timeout) => setTimeout(check, timeout));\n  window.addEventListener(\"hashchange\", check, {\n    passive: true,\n    capture: false,\n  });\n\n  function check() {\n    const { hash } = window.location;\n\n    if (isEmptyHash()) {\n      remove_hash();\n      return;\n    }\n\n    if (!IGNORE_LIST && !INCLUDE_LIST) {\n      return;\n    }\n    if (IGNORE_LIST && IGNORE_LIST.includes(hash)) {\n      return;\n    }\n    if (INCLUDE_LIST && !INCLUDE_LIST.includes(hash)) {\n      return;\n    }\n\n    remove_hash();\n  }\n}\n\nfunction isEmptyHash() {\n  // In Chrome `location.hash===''` when URL is `localhost:3000/#`\n  if (window.location.hash === \"#\") {\n    return true;\n  }\n  // Because the above doesn't seem to be reliable\n  if (window.location.href.endsWith(\"#\")) {\n    return true;\n  }\n  return false;\n}\n","import React from \"react\";\n\nexport { SettingsView };\n\nfunction SettingsView({ preset_concept_name }) {\n  return (\n    <>\n      <div className=\"more_panel_block\">\n        <div className=\"more_panel_block_title\">{preset_concept_name}</div>\n        <div id=\"creator-content\" />\n      </div>\n      <div id=\"save-container\" className=\"more_panel_block\">\n        <div className=\"more_panel_block_title\">Save</div>\n        <div id=\"save-content\" />\n      </div>\n      <div id=\"options-container\" className=\"more_panel_block\">\n        <div className=\"more_panel_block_title\">Options</div>\n        <div id=\"options-content\" />\n      </div>\n      <div id=\"share-container\" className=\"more_panel_block\">\n        <div className=\"more_panel_block_title\">Share</div>\n        <div id=\"share-preamble\">\n          You can create and share {preset_concept_name}s; customize an existing{\" \"}\n          {preset_concept_name}, save it under a new name, then use its share\n          link.\n        </div>\n        <div id=\"share-content\">Share Link: </div>\n      </div>\n    </>\n  );\n}\n","import assert from \"@brillout/assert\";\n\nexport default load_font;\n\nasync function load_font(font_name) {\n  assert(font_name, { font_name });\n\n  const WebFont = require(\"webfontloader\");\n\n  let resolve;\n  const promise = new Promise((r) => (resolve = r));\n\n  attempts = 0;\n  do_it();\n\n  await promise;\n\n  return;\n\n  var attempts;\n  function do_it() {\n    assert(font_name, { font_name });\n    WebFont.load({\n      ...get_font_spec(font_name),\n      fontactive: resolve,\n      fontinactive: () => {\n        attempts++;\n        const min = Math.pow(2, attempts);\n        const max = 60;\n        const seconds = Math.max(min, max);\n        const timeout = seconds * 1000;\n        setTimeout(do_it, timeout);\n      },\n    });\n  }\n}\n\nfunction get_font_spec(font_name) {\n  const HOSTED = [\"AirbnbCereal\", \"LCD\"];\n  if (HOSTED.includes(font_name)) {\n    return {\n      custom: {\n        families: [font_name],\n        urls: [\"/fonts/\" + font_name + \"/\" + font_name + \".css\"],\n      },\n    };\n  } else {\n    return {\n      google: {\n        families: [font_name],\n      },\n    };\n  }\n}\n","export { load_asap };\n\nlet head;\n\nfunction load_asap(url, onsuccess) {\n  head = head || document.getElementsByTagName(\"head\")[0];\n\n  var attempts = 0;\n  function do_() {\n    //using same script el => onerror doesn't get called again in chrome\n    var script = document.createElement(\"script\");\n    script.src = url;\n    //script.type= 'text/javascript';\n    script.onerror = function () {\n      head.removeChild(script);\n      setTimeout(do_, Math.min(Math.pow(2, attempts) * 1000, 60000));\n    };\n    //proxy redirects url -> false onsuccess\n    //-no way found to catch this\n    if (onsuccess) script.onload = onsuccess;\n    attempts++;\n    head.appendChild(script);\n  }\n  do_();\n}\n","import { load_asap } from \"./load_asap\";\n\nexport default load_font_list;\n\nlet promise;\n\nfunction load_font_list() {\n  if (promise) {\n    return promise;\n  }\n\n  let resolve_promise;\n  promise = new Promise((r) => (resolve_promise = r));\n\n  window[\"onfontsload\"] = function (resp) {\n    if (resp.error) {\n      console.error(resp.error.message);\n      resolve_promise([]);\n      return;\n    }\n\n    let font_list = resp[\"items\"].map((f) => f.family).sort();\n\n    /*\n    if(ml.browser().usesGecko) {\n      // Firefox crashes when selecting a from too many options\n      const MAX = 300;\n      font_list = font_list.slice(0, MAX);\n    }\n    */\n\n    resolve_promise(font_list);\n  };\n\n  load_asap(\n    \"https://www.googleapis.com/webfonts/v1/webfonts?callback=onfontsload&sort=popularity&key=AIzaSyAOMrdvfJJPa1btlQNCkXT9gcA-lCADPeE\"\n  );\n\n  return promise;\n}\n","\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport assert from \"@brillout/assert\";\nimport \"./set_background.css\";\nexport { set_background }; //tricky bg images to test:\n//-http://static.panoramio.com/photos/original/3719338.jpg\n//-cover test: http://cdn.techpp.com/wp-content/uploads/2008/10/gmail_logo.jpg\n//black floor: http://img.wallpaperstock.net:81/black-floor-wallpapers_6854_1680x1050.jpg\n//http://lh6.googleusercontent.com/-AAQe-KJXX-w/TcRrpukjk6I/AAAAAAAACwE/-7gmjOI-ctQ/IMG_2649mod.jpg\n//http://www.a-better-tomorrow.com/blog/wp-content/wallpaper_abt1.jpg\n//http://www.gowallpaper.net/wp-content/uploads/2011/04/Windows-7-3d-wide-wallpaper-1280x800.jpg\n//http://vistawallpapers.files.wordpress.com/2007/03/vista-wallpapers-69.jpg\n//to test: resize image to screen.width and screen.height using canvas and webworkers\n//window.screen.width;\n//window.screen.height;\n\nfunction set_background(_x, _x2, _x3) {\n  return _set_background.apply(this, arguments);\n}\n\nfunction _set_background() {\n  _set_background = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(color_code, image_uri, bg_container_selector) {\n    var is_outdated, bg_img_val;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            is_outdated = get_is_outdated();\n            init(bg_container_selector);\n            _context.next = 4;\n            return load_image(image_uri, is_outdated);\n\n          case 4:\n            bg_img_val = _context.sent;\n\n            if (!is_outdated()) {\n              _context.next = 7;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 7:\n            apply(color_code, bg_img_val, false);\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _set_background.apply(this, arguments);\n}\n\nfunction apply(color_code, bg_img_val, show_loader) {\n  apply_color(color_code);\n  apply_image(bg_img_val);\n  BG_EL.classList[show_loader ? \"add\" : \"remove\"](\"show-load-indicator\");\n}\n\nfunction load_image(_x4, _x5) {\n  return _load_image.apply(this, arguments);\n}\n\nfunction _load_image() {\n  _load_image = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(image_uri, is_outdated) {\n    var is_data_uri, bg_img_val, imgEl, resolve, promise, loaded, on_load, on_error, set_loader_indicator;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            set_loader_indicator = function _ref3() {\n              window.setTimeout(function () {\n                if (is_outdated()) {\n                  return;\n                }\n\n                if (loaded) {\n                  return;\n                }\n\n                apply(null, null, true);\n              }, 50);\n            };\n\n            on_error = function _ref2() {\n              if (!is_outdated()) {\n                alert(\"Image \" + image_uri + \" could not be loaded. Is the image online? Do you have an internet connection? Does the URL point to an image? (Note that the URL should point to the image itself and not to a page containing the image.)\");\n              }\n            };\n\n            on_load = function _ref() {\n              var w = imgEl.width;\n              var h = imgEl.height;\n\n              if (w * h > 8000000) {\n                if (!is_outdated()) {\n                  alert(\"The provided image has a size of \" + w + \"*\" + h + \" pixels. Large images are likely to slow down your machine. Thus only images of up to 8 000 000 pixels are allowed. (For example, any image bellow 5000*1600 is fine.)\");\n                }\n\n                return null;\n              } else {\n                return 'url(\"' + image_uri + '\")';\n              }\n            };\n\n            if (image_uri) {\n              _context2.next = 5;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", null);\n\n          case 5:\n            is_data_uri = /^data:image/.test(image_uri);\n\n            if (!is_data_uri) {\n              _context2.next = 9;\n              break;\n            }\n\n            bg_img_val = image_uri + \"\";\n            return _context2.abrupt(\"return\", bg_img_val);\n\n          case 9:\n            imgEl = document.createElement(\"img\");\n            promise = new Promise(function (r) {\n              resolve = r;\n            });\n            loaded = false;\n\n            imgEl.onload = function () {\n              loaded = true;\n              var image_val = on_load();\n              resolve(image_val);\n            };\n\n            imgEl.onerror = function () {\n              loaded = true;\n              on_error();\n              resolve(null);\n            };\n\n            set_loader_indicator();\n            imgEl.src = image_uri;\n            return _context2.abrupt(\"return\", promise);\n\n          case 17:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _load_image.apply(this, arguments);\n}\n\nfunction apply_color(color_code) {\n  color_code = color_code || \"transparent\";\n\n  if (BG_EL.style.backgroundColor !== color_code) {\n    BG_EL.style.backgroundColor = color_code;\n  }\n}\n\nfunction apply_image(bg_img_val) {\n  bg_img_val = bg_img_val || \"none\";\n\n  if (BG_EL.style.backgroundImage !== bg_img_val) {\n    BG_EL.style.backgroundImage = bg_img_val;\n  }\n}\n\nvar BG_EL;\nvar bg_container_;\nvar bg_container_selector_;\n\nfunction init(bg_container_selector) {\n  assert(bg_container_selector, {\n    bg_container_selector: bg_container_selector\n  });\n  assert(bg_container_selector_ === undefined || bg_container_selector === bg_container_selector_, {\n    bg_container_selector: bg_container_selector,\n    bg_container_selector_: bg_container_selector_\n  });\n  bg_container_selector_ = bg_container_selector;\n  var bg_container = document.querySelector(bg_container_selector);\n  assert(bg_container, {\n    bg_container_selector: bg_container_selector\n  });\n  assert(bg_container_ === undefined || bg_container_ === bg_container, {\n    bg_container: bg_container,\n    bg_container_: bg_container_\n  });\n\n  if (BG_EL) {\n    return;\n  }\n\n  var el1 = document.createElement(\"div\");\n  el1.id = \"background-area-wrapper\";\n  var el2 = document.createElement(\"div\");\n  el2.id = \"background-area\";\n  el2.style.backgroundSize = \"cover\";\n  el1.prepend(el2);\n  bg_container.prepend(el1);\n  BG_EL = el2;\n}\n\nvar call_number = 0;\n\nfunction get_is_outdated() {\n  ++call_number;\n  var current = call_number;\n\n  var is_outdated = function is_outdated() {\n    return current !== call_number;\n  };\n\n  return is_outdated;\n}","\"use strict\";\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _classPrivateFieldLooseBase(receiver, privateKey) { if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) { throw new TypeError(\"attempted to use private field on non-instance\"); } return receiver; }\n\nvar id = 0;\n\nfunction _classPrivateFieldLooseKey(name) { return \"__private_\" + id++ + \"_\" + name; }\n\nimport assert from \"@brillout/assert\";\nimport flatpickr from \"flatpickr\";\nimport \"flatpickr/dist/flatpickr.css\";\nimport { store } from \"../store\";\nimport { escape_html } from \"../utils/escape_html\";\nexport { TextInput, BooleanInput, SelectInput, ColorInput, DateInput, Button, PersistantInput };\n\nvar PersistantInput = /*#__PURE__*/function () {\n  function PersistantInput(props) {\n    _classCallCheck(this, PersistantInput);\n\n    this._props = void 0;\n    this._input_id = void 0;\n    Object.defineProperty(this, _on_input_change, {\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, _input_default, {\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, _storage_key, {\n      writable: true,\n      value: void 0\n    });\n    this.input_tag = void 0;\n    this.input_type = void 0;\n    this._dom_el = void 0;\n    this._input_el = void 0;\n    this._props = props;\n    var input_id = props.input_id,\n        on_input_change = props.on_input_change,\n        input_default = props.input_default;\n    assert(input_id && on_input_change);\n    this._input_id = input_id;\n    _classPrivateFieldLooseBase(this, _on_input_change)[_on_input_change] = on_input_change;\n    _classPrivateFieldLooseBase(this, _input_default)[_input_default] = input_default;\n    _classPrivateFieldLooseBase(this, _storage_key)[_storage_key] = input_id;\n  } // Public functions\n\n\n  _createClass(PersistantInput, [{\n    key: \"input_get\",\n    value: function input_get() {\n      return this._input_retriever();\n    }\n  }, {\n    key: \"has_stored_value\",\n    value: function has_stored_value() {\n      return store.has_val(_classPrivateFieldLooseBase(this, _storage_key)[_storage_key]);\n    }\n  }, {\n    key: \"get_stored_value\",\n    value: function get_stored_value() {\n      return store.get_val(_classPrivateFieldLooseBase(this, _storage_key)[_storage_key]);\n    }\n  }, {\n    key: \"set_stored_value\",\n    value: function set_stored_value(val) {\n      store.set_val(_classPrivateFieldLooseBase(this, _storage_key)[_storage_key], val);\n    }\n  }, {\n    key: \"input_set\",\n    value: function input_set(val) {\n      this.set_stored_value(val);\n\n      this._input_modifier(val);\n\n      _classPrivateFieldLooseBase(this, _on_input_change)[_on_input_change]();\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this = this;\n\n      var input_tag = this.input_tag,\n          input_type = this.input_type;\n      assert(input_tag);\n      assert(input_type || input_tag !== \"input\");\n\n      var _generate_input = generate_input(_objectSpread({\n        input_tag: input_tag,\n        input_type: input_type\n      }, this._props)),\n          dom_el = _generate_input.dom_el,\n          input_el = _generate_input.input_el;\n\n      this._dom_el = dom_el;\n      this._input_el = input_el;\n\n      if (this._init_dom) {\n        this._init_dom();\n      }\n\n      var init_val = this.has_stored_value() ? this.get_stored_value() : _classPrivateFieldLooseBase(this, _input_default)[_input_default];\n\n      if (init_val !== undefined) {\n        this._input_modifier(init_val);\n      }\n\n      this._input_el.addEventListener(this._change_event, function () {\n        var val = _this._input_retriever();\n\n        _this.set_stored_value(val);\n\n        _classPrivateFieldLooseBase(_this, _on_input_change)[_on_input_change]();\n      }, false);\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      hide_show_el(this._dom_el, true);\n    }\n  }, {\n    key: \"show\",\n    value: function show() {\n      hide_show_el(this._dom_el);\n    } // To be overriden\n\n  }, {\n    key: \"_input_retriever\",\n    value: function _input_retriever() {\n      return this._input_el.value;\n    }\n  }, {\n    key: \"_input_modifier\",\n    value: function _input_modifier(val) {\n      this._input_el.value = val;\n    }\n  }, {\n    key: \"_change_event\",\n    get: function get() {\n      return \"change\";\n    }\n  }]);\n\n  return PersistantInput;\n}();\n\nvar _on_input_change = _classPrivateFieldLooseKey(\"on_input_change\");\n\nvar _input_default = _classPrivateFieldLooseKey(\"input_default\");\n\nvar _storage_key = _classPrivateFieldLooseKey(\"storage_key\");\n\nvar BooleanInput = /*#__PURE__*/function (_PersistantInput) {\n  _inherits(BooleanInput, _PersistantInput);\n\n  function BooleanInput(args) {\n    var _this2;\n\n    _classCallCheck(this, BooleanInput);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(BooleanInput).call(this, args));\n    _this2.input_tag = void 0;\n    _this2.input_type = void 0;\n    _this2.input_tag = \"input\";\n    _this2.input_type = \"checkbox\";\n    return _this2;\n  }\n\n  _createClass(BooleanInput, [{\n    key: \"_input_retriever\",\n    value: function _input_retriever() {\n      return !!this._input_el.checked;\n    }\n  }, {\n    key: \"_input_modifier\",\n    value: function _input_modifier(val) {\n      if (!!val) {\n        this._input_el.setAttribute(\"checked\", \"true\");\n      } else {\n        this._input_el.removeAttribute(\"checked\");\n      }\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      _get(_getPrototypeOf(BooleanInput.prototype), \"init\", this).call(this);\n\n      this._dom_el[\"classList\"][\"add\"](\"pointer-cursor\");\n    }\n  }]);\n\n  return BooleanInput;\n}(PersistantInput);\n\nvar TextInput = /*#__PURE__*/function (_PersistantInput2) {\n  _inherits(TextInput, _PersistantInput2);\n\n  function TextInput(args) {\n    var _this3;\n\n    _classCallCheck(this, TextInput);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(TextInput).call(this, args));\n    _this3.input_tag = void 0;\n    _this3.input_type = void 0;\n    _this3.input_tag = \"input\";\n    _this3.input_type = \"text\";\n    return _this3;\n  }\n\n  _createClass(TextInput, [{\n    key: \"init\",\n    value: function init() {\n      _get(_getPrototypeOf(TextInput.prototype), \"init\", this).call(this);\n\n      var input_placeholder = this._props.input_placeholder;\n\n      if (input_placeholder) {\n        this._input_el.placeholder = input_placeholder;\n      }\n    }\n  }, {\n    key: \"_change_event\",\n    get: function get() {\n      // `input` event seem to only be reliably fired for text inputs\n      //  - https://caniuse.com/#feat=input-event\n      return \"input\";\n    }\n  }]);\n\n  return TextInput;\n}(PersistantInput);\n\nvar SelectInput = /*#__PURE__*/function (_PersistantInput3) {\n  _inherits(SelectInput, _PersistantInput3);\n\n  _createClass(SelectInput, [{\n    key: \"refresh\",\n    value: function refresh() {\n      this._init_dom();\n    }\n  }], [{\n    key: \"get_divider\",\n    value: function get_divider(text) {\n      var divider_text;\n\n      if (text) {\n        divider_text = \" \" + text + \" \";\n      } else {\n        divider_text = \"\";\n      }\n\n      var divider_html = \"<option disabled>\" + divider_text + \"</option>\";\n      return {\n        divider_html: divider_html\n      };\n    }\n  }]);\n\n  function SelectInput(_ref) {\n    var _this4;\n\n    var input_options = _ref.input_options,\n        args = _objectWithoutProperties(_ref, [\"input_options\"]);\n\n    _classCallCheck(this, SelectInput);\n\n    _this4 = _possibleConstructorReturn(this, _getPrototypeOf(SelectInput).call(this, args));\n    _this4.input_tag = void 0;\n    _this4.input_options = void 0;\n    _this4.input_tag = \"select\";\n    _this4.input_options = input_options;\n    return _this4;\n  }\n\n  _createClass(SelectInput, [{\n    key: \"_init_dom\",\n    value: function _init_dom() {\n      var _this5 = this;\n\n      assert(this.input_options.length > 0, this._input_id);\n      var innerHTML = \"\";\n      this.input_options.forEach(function (option_arg) {\n        innerHTML += _this5._generate_option_html(option_arg);\n      });\n      this._input_el.innerHTML = innerHTML;\n    }\n  }, {\n    key: \"add_options\",\n    value: function add_options(new_options) {\n      var _this6 = this;\n\n      var current_value = this._input_retriever();\n\n      var current_option_values = Array.from(this._input_el.querySelector(\"option\")).map(function (el) {\n        return el.value;\n      });\n      var innerHTML = this._input_el.innerHTML;\n      new_options.forEach(function (option_arg) {\n        var _this6$_parse_option_ = _this6._parse_option_arg(option_arg),\n            val = _this6$_parse_option_.val;\n\n        if (val && current_option_values.includes(val)) {\n          return;\n        }\n\n        innerHTML += _this6._generate_option_html(option_arg);\n      });\n      this._input_el.innerHTML = innerHTML;\n\n      this._input_modifier(current_value);\n    }\n  }, {\n    key: \"_input_modifier\",\n    value: function _input_modifier(val) {\n      assert(val, \"empty select\", val === \"\", this._input_el.id, {\n        val: val\n      });\n\n      if (!this._input_el.querySelector('option[value=\"' + val + '\"]')) {\n        this._input_el.innerHTML = this._generate_option_html(val) + SelectInput.get_divider().divider_html + this._input_el.innerHTML;\n      }\n\n      _get(_getPrototypeOf(SelectInput.prototype), \"_input_modifier\", this).call(this, val);\n    }\n  }, {\n    key: \"_generate_option_html\",\n    value: function _generate_option_html(option_arg) {\n      var _this$_parse_option_a = this._parse_option_arg(option_arg),\n          val = _this$_parse_option_a.val,\n          val_pretty = _this$_parse_option_a.val_pretty,\n          divider_html = _this$_parse_option_a.divider_html;\n\n      if (divider_html) {\n        return divider_html;\n      }\n\n      return '<option label=\"' + val_pretty + '\" value=\"' + val + '\">' + escape_html(val_pretty) + \"</option>\";\n    }\n  }, {\n    key: \"_parse_option_arg\",\n    value: function _parse_option_arg(option_arg) {\n      assert(option_arg, this._input_id, {\n        option_arg: option_arg\n      });\n      var divider_html = option_arg.divider_html;\n\n      if (divider_html) {\n        return {\n          divider_html: divider_html\n        };\n      }\n\n      var val = option_arg.val || option_arg;\n      assert(val && val.constructor === String, option_arg);\n      var val_pretty = option_arg.val_pretty || val;\n      assert(val_pretty.constructor === String, val_pretty);\n      return {\n        val: val,\n        val_pretty: val_pretty\n      };\n    }\n  }]);\n\n  return SelectInput;\n}(PersistantInput);\n\nvar DateInput = /*#__PURE__*/function (_PersistantInput4) {\n  _inherits(DateInput, _PersistantInput4);\n\n  function DateInput() {\n    var _getPrototypeOf2;\n\n    var _this7;\n\n    _classCallCheck(this, DateInput);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this7 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(DateInput)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this7.input_tag = \"input\";\n    _this7.input_type = \"datetime\";\n    return _this7;\n  }\n\n  _createClass(DateInput, [{\n    key: \"_init_dom\",\n\n    /*\n    constructor(args) {\n      super(args);\n      this.input_tag = 'input';\n      this.input_type = 'datetime';\n    }\n    */\n    value: function _init_dom() {\n      flatpickr(this._input_el, {\n        enableTime: true\n        /*\n        dateFormat: \"Y-m-d H:i\",\n        altInput: true,\n        altFormat: \"F j, Y\",\n        dateFormat: \"Y-m-d\",\n        */\n\n      });\n    }\n  }]);\n\n  return DateInput;\n}(PersistantInput);\n\nvar ColorInput = /*#__PURE__*/function (_PersistantInput5) {\n  _inherits(ColorInput, _PersistantInput5);\n\n  function ColorInput(args) {\n    var _this8;\n\n    _classCallCheck(this, ColorInput);\n\n    _this8 = _possibleConstructorReturn(this, _getPrototypeOf(ColorInput).call(this, args));\n    _this8.input_tag = void 0;\n    _this8.input_type = void 0;\n    _this8.input_tag = \"input\";\n    _this8.input_type = \"color\";\n    return _this8;\n  }\n\n  _createClass(ColorInput, [{\n    key: \"init\",\n    value: function init() {\n      _get(_getPrototypeOf(ColorInput.prototype), \"init\", this).call(this);\n\n      this._dom_el[\"classList\"][\"add\"](\"pointer-cursor\");\n    }\n  }]);\n\n  return ColorInput;\n}(PersistantInput);\n\nvar Button = /*#__PURE__*/function () {\n  function Button(_ref2) {\n    var on_click = _ref2.on_click,\n        text = _ref2.text,\n        input_container = _ref2.input_container,\n        _ref2$className = _ref2.className,\n        className = _ref2$className === void 0 ? null : _ref2$className,\n        id = _ref2.id;\n\n    _classCallCheck(this, Button);\n\n    this.on_click = void 0;\n    this.text = void 0;\n    this.input_container = void 0;\n    this.className = void 0;\n    this.id = void 0;\n    this.dom_el = void 0;\n    this.on_click = on_click;\n    this.text = text;\n    this.input_container = input_container;\n    this.className = className;\n    this.id = id;\n  }\n\n  _createClass(Button, [{\n    key: \"generate_dom\",\n    value: function generate_dom() {\n      var _this9 = this;\n\n      var dom_el = document.createElement(\"button\");\n\n      if (this.className) {\n        dom_el.setAttribute(\"class\", this.className);\n      }\n\n      dom_el.setAttribute(\"type\", \"button\");\n      dom_el.setAttribute(\"id\", this.id);\n\n      dom_el.onclick = function (ev) {\n        ev.preventDefault();\n\n        _this9.on_click();\n      };\n\n      dom_el.textContent = this.text;\n      this.input_container.appendChild(dom_el);\n      this.dom_el = dom_el;\n    } // to-do: as mixin\n\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      hide_show_el(this.dom_el, true);\n    }\n  }, {\n    key: \"show\",\n    value: function show() {\n      hide_show_el(this.dom_el);\n    }\n  }]);\n\n  return Button;\n}();\n/*\nconst global_debouncer.debounce = new GlobalDebouncer();\n\nclass GlobalDebouncer {\n  constructor() {\n    this._lastTimeout;\n    requestAnimationFrame\n    cancelAnimationFrame\n  }\n\n  debounce(fn) {\n    return () => {\n\n      fn();\n    };\n  }\n}\n*/\n\n\nfunction generate_input(_ref3) {\n  var input_tag = _ref3.input_tag,\n      input_type = _ref3.input_type,\n      input_id = _ref3.input_id,\n      input_description = _ref3.input_description,\n      input_width = _ref3.input_width,\n      input_container = _ref3.input_container;\n  assert(input_tag);\n  assert(input_type || input_tag !== \"input\");\n  assert(input_id);\n  assert(input_container, {\n    input_id: input_id\n  });\n  var dom_el = document.createElement(\"label\");\n  assert([\"select\", \"input\"].includes(input_tag));\n  var input_el = document.createElement(input_tag);\n  input_el.id = input_id;\n  if (input_type) input_el.setAttribute(\"type\", input_type);\n  var description_el;\n\n  if (input_description) {\n    description_el = document.createElement(\"span\");\n    description_el.textContent = input_description; //+'&nbsp;';\n  }\n\n  if (input_type === \"checkbox\") {\n    dom_el.appendChild(input_el);\n\n    if (description_el) {\n      dom_el.appendChild(description_el);\n    }\n  } else {\n    if (description_el) {\n      dom_el.appendChild(description_el);\n    }\n\n    dom_el.appendChild(input_el);\n  }\n\n  if (input_width) {\n    input_el.style.width = input_width;\n  }\n\n  input_container.appendChild(dom_el);\n  return {\n    dom_el: dom_el,\n    input_el: input_el\n  };\n}\n\nfunction hide_show_el(el) {\n  var to_hide = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n  if (to_hide) {\n    el.setAttribute(\"disabled\", \"true\");\n  } else {\n    el.removeAttribute(\"disabled\");\n  }\n\n  el.style.width = to_hide ? \"0px\" : \"\";\n  el.style.height = to_hide ? \"0px\" : \"\";\n  el.style.visibility = to_hide ? \"hidden\" : \"visible\";\n  el.style.position = to_hide ? \"absolute\" : \"\";\n  el.style.zIndex = to_hide ? \"-1\" : \"\";\n}","\"use strict\";\n\nexport { escape_html };\n\nfunction escape_html(str) {\n  return str.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#039;\");\n}","export { rename_keys_and_values };\n\nfunction rename_keys_and_values({ key_replacements, value_replacements }) {\n  const db = {};\n\n  let has_changes = false;\n\n  Object.entries(localStorage).forEach(([key, val]) => {\n    if (key_replacements && key in key_replacements) {\n      key = key_replacements[key];\n      has_changes = true;\n    }\n\n    if (\n      value_replacements &&\n      key in value_replacements &&\n      val in value_replacements[key]\n    ) {\n      val = value_replacements[key][val];\n      has_changes = true;\n    }\n\n    db[key] = val;\n  });\n\n  if (!has_changes) {\n    return;\n  }\n\n  if (has_changes) {\n    localStorage.clear();\n\n    Object.keys(db).forEach((key) => {\n      localStorage[key] = db[key];\n    });\n  }\n\n  return has_changes;\n}\n","import assert from \"@brillout/assert\";\nimport { rename_keys_and_values } from \"./rename_keys_and_values\";\n\nmigrate_ancient_schema.schema_version = new Date(\"2020-03-01\");\n\nexport { migrate_ancient_schema };\n\nfunction migrate_ancient_schema() {\n  rename_keys_and_values({\n    key_replacements: {\n      theme: \"clock_theme\",\n      bg_image: \"clock_background_image\",\n      bg_color: \"clock_background_color\",\n      font_shadow: \"clock_shadow\",\n      color_font: \"clock_color\",\n      font_size: \"clock_size\",\n      [\"12_hour\"]: \"clock_twelve_hour_format\",\n      show_pm: \"clock_display_period\",\n      show_seconds: \"clock_display_seconds\",\n      show_date: \"clock_display_date\",\n      show_week: \"clock_display_week\",\n      show_seconds_title: \"clock_tab_display_seconds\",\n      color_icon: \"clock_tab_icon_color\",\n    },\n    value_replacements: {\n      clock_theme: {\n        \"\": \"_creator\",\n        random: \"_random\",\n      },\n    },\n  });\n}\n","export { migrate_user_presets };\n\nfunction migrate_user_presets(migrator) {\n  [\"countdown_presets\", \"clock_presets\"].forEach((presets__storage_key) => {\n    const presets__string = localStorage[presets__storage_key];\n    if (!presets__string) {\n      return;\n    }\n    const presets = JSON.parse(presets__string);\n    let has_changes = false;\n    presets.forEach((preset) => {\n      if (migrator(preset)) {\n        has_changes = true;\n      }\n    });\n    if (has_changes) {\n      const presets__string__updated = JSON.stringify(presets);\n      localStorage[presets__storage_key] = presets__string__updated;\n    }\n  });\n}\n","import assert from \"@brillout/assert\";\nimport { migrate_user_presets } from \"./migrate_user_presets\";\n\nmigrate_user_preset_ids_and_values.schema_version = new Date(\"2020-03-02\");\n\nexport { migrate_user_preset_ids_and_values };\n\nfunction migrate_user_preset_ids_and_values() {\n  migrate_user_presets((preset) => {\n    assert(preset.preset_name || preset.preset_id);\n    if (preset.preset_name) {\n      preset.preset_id = preset.preset_name;\n      delete preset.preset_name;\n      return true;\n    }\n    assert(preset.preset_options || preset.preset_values);\n    if (preset.preset_options) {\n      preset.preset_values = preset.preset_options;\n      delete preset.preset_options;\n      return true;\n    }\n  });\n}\n","import assert from \"@brillout/assert\";\nimport { migrate_user_presets } from \"./migrate_user_presets\";\n\nmigrate_subapp_id.schema_version = new Date(\"2020-03-03\");\n\nexport { migrate_subapp_id };\n\nfunction migrate_subapp_id() {\n  migrate_user_presets((preset) => {\n    assert(preset.app_name || preset.subapp_id);\n    if (preset.app_name) {\n      preset.subapp_id = preset.app_name;\n      delete preset.app_name;\n      return true;\n    }\n  });\n}\n","import assert from \"@brillout/assert\";\nimport { rename_keys_and_values } from \"./rename_keys_and_values\";\n\nmigrate_old_timer_tab_schema.schema_version = new Date(\"2020-03-04\");\n\nexport { migrate_old_timer_tab_schema };\n\nfunction migrate_old_timer_tab_schema() {\n  const has_changes = rename_keys_and_values({\n    key_replacements: {\n      bg_url: \"timer_background_image\",\n      goto_url: \"timer_youtube_alarm\",\n    },\n  });\n  if (has_changes) {\n    localStorage[\"timer_theme\"] = \"_creator\";\n  }\n}\n","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport { store } from \"../../store\";\nmigrate_to_centralized_store.schema_version = new Date(\"2020-04-21\");\nexport { migrate_to_centralized_store };\n\nfunction migrate_to_centralized_store() {\n  Object.entries(localStorage).forEach(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        val = _ref2[1];\n\n    if (key.startsWith(\"timer_\") || key.startsWith(\"clock_\") || key.startsWith(\"countdown_\") || key === \"thanks-for-your-donation\") {\n      if (key.endsWith(\"_presets\")) {\n        val = JSON.parse(val);\n      }\n\n      if (key === \"thanks-for-your-donation\") {\n        val = true;\n      }\n\n      store.set_val(key, val);\n      window.localStorage.removeItem(key);\n    }\n  });\n  store.migrate__rename_keys({\n    \"thanks-for-your-donation\": \"ad_removal\"\n  });\n}","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _classPrivateFieldLooseBase(receiver, privateKey) { if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) { throw new TypeError(\"attempted to use private field on non-instance\"); } return receiver; }\n\nvar id = 0;\n\nfunction _classPrivateFieldLooseKey(name) { return \"__private_\" + id++ + \"_\" + name; }\n\nimport assert from \"@brillout/assert\";\nimport load_font from \"./load_font\";\nimport _load_font_list from \"./load_font_list\";\nimport { set_background } from \"./set_background/set_background\";\nimport \"./tab-settings.css\";\nimport { track_event, track_error } from \"../views/common/tracker\";\nimport { remove_hash } from \"../auto_remove_hash\";\nimport { TextInput, BooleanInput, SelectInput, ColorInput, DateInput, Button } from \"./PersistantInput\";\nimport { show_toast } from \"../views/common/show_toast\";\nimport { run_migrations } from \"./run_migrations\";\nimport { store, deserialize, serialize } from \"../store\";\nrun_migrations();\nexport var TabSettings = /*#__PURE__*/function () {\n  function TabSettings(_ref) {\n    var _this = this;\n\n    var option_spec_list = _ref.option_spec_list,\n        preset_spec_list = _ref.preset_spec_list,\n        _ref$text_container = _ref.text_container,\n        text_container = _ref$text_container === void 0 ? null : _ref$text_container,\n        _ref$no_random_preset = _ref.no_random_preset,\n        no_random_preset = _ref$no_random_preset === void 0 ? false : _ref$no_random_preset,\n        on_any_change = _ref.on_any_change,\n        _ref$on_font_change = _ref.on_font_change,\n        on_font_change = _ref$on_font_change === void 0 ? null : _ref$on_font_change,\n        enable_import_export = _ref.enable_import_export,\n        subapp_id = _ref.subapp_id,\n        preset_concept_name = _ref.preset_concept_name;\n\n    _classCallCheck(this, TabSettings);\n\n    this.preset_concept_name = void 0;\n    this.text_container = void 0;\n    this.no_random_preset = void 0;\n    this.on_any_change = void 0;\n    this.on_font_change = void 0;\n    this.enable_import_export = void 0;\n    this.subapp_id = void 0;\n    this.creator_content = void 0;\n    this.options_content = void 0;\n    this.options_container = void 0;\n    this.save_content = void 0;\n    this.save_container = void 0;\n    this.share_content = void 0;\n    this.share_container = void 0;\n    this.preset_list = void 0;\n    this.option_list = void 0;\n    this.resolve_font_loaded_promise = void 0;\n    this.font_loaded_promise = void 0;\n    this.button_mod = void 0;\n    this.button_del = void 0;\n    this.name_option = void 0;\n    this.button_url = void 0;\n    Object.defineProperty(this, _global_side_effects__timeout, {\n      writable: true,\n      value: null\n    });\n    Object.defineProperty(this, _previous_link, {\n      writable: true,\n      value: null\n    });\n    Object.defineProperty(this, _link_el, {\n      writable: true,\n      value: null\n    });\n    Object.defineProperty(this, _font_list_already_loading, {\n      writable: true,\n      value: false\n    });\n    assert(preset_concept_name);\n    {\n      var hasTextFontInput = !!option_spec_list.find(function (_ref2) {\n        var option_type = _ref2.option_type;\n        return option_type === \"text-font-input\";\n      });\n      var hasTextShadowInput = !!option_spec_list.find(function (_ref3) {\n        var option_type = _ref3.option_type;\n        return option_type === \"text-shadow-input\";\n      });\n      var hasTextColorInput = !!option_spec_list.find(function (_ref4) {\n        var option_type = _ref4.option_type;\n        return option_type === \"text-color-input\";\n      });\n      assert(!text_container && !on_font_change && !hasTextFontInput && !hasTextShadowInput && !hasTextColorInput || text_container && on_font_change && hasTextFontInput && hasTextShadowInput && hasTextColorInput);\n    }\n    this.preset_concept_name = preset_concept_name;\n    this.text_container = text_container;\n    this.no_random_preset = no_random_preset;\n    this.on_any_change = on_any_change;\n    this.on_font_change = on_font_change;\n    this.enable_import_export = enable_import_export;\n    this.subapp_id = subapp_id;\n    this.creator_content = document.getElementById(\"creator-content\");\n    this.options_content = document.getElementById(\"options-content\");\n    this.options_container = document.getElementById(\"options-container\");\n    this.save_content = document.getElementById(\"save-content\");\n    this.save_container = document.getElementById(\"save-container\");\n    this.share_content = document.getElementById(\"share-content\");\n    this.share_container = document.getElementById(\"share-container\");\n    this.preset_list = new PresetList({\n      preset_spec_list: preset_spec_list,\n      tab_settings: this\n    });\n    this.option_list = instantiate_options({\n      tab_settings: this,\n      option_spec_list: option_spec_list\n    });\n    this.resolve_font_loaded_promise;\n    this.font_loaded_promise = new Promise(function (r) {\n      return _this.resolve_font_loaded_promise = r;\n    });\n  }\n\n  _createClass(TabSettings, [{\n    key: \"generate_dom\",\n    value: function generate_dom() {\n      this.option_list.forEach(function (opt) {\n        opt.generate_dom();\n      });\n\n      if (this.enable_import_export) {\n        this.generate_import_export_dom();\n      }\n\n      this.global_side_effects({\n        is_initial_run: true\n      });\n    }\n  }, {\n    key: \"generate_import_export_dom\",\n    value: function generate_import_export_dom() {\n      var _this2 = this;\n\n      var input_container = this.creator_content;\n      {\n        var btn = new Button({\n          input_container: input_container,\n          text: \"Customize\",\n          className: \"action-button\",\n          on_click: function on_click() {\n            _this2.modify_preset();\n          },\n          id: \"modify-preset-button\"\n        });\n        btn.generate_dom();\n        this.button_mod = btn;\n      }\n      {\n        var _btn = new Button({\n          input_container: input_container,\n          text: \"Delete\",\n          className: \"action-button\",\n          on_click: function on_click() {\n            _this2.delete_preset();\n          },\n          id: \"delete-preset-button\"\n        });\n\n        _btn.generate_dom();\n\n        this.button_del = _btn;\n      }\n      input_container = this.save_content;\n      {\n        var subapp_id = this.subapp_id;\n        assert(subapp_id);\n        var name_option = new TextOption({\n          input_container: input_container,\n          option_id: subapp_id + \"_name\",\n          input_width: \"150px\",\n          option_description: this.preset_concept_name + \" name\",\n          option_default: \"\",\n          tab_settings: this,\n          id: \"preset-name-input\"\n        });\n        name_option.generate_dom();\n        this.name_option = name_option;\n      }\n      {\n        var _btn2 = new Button({\n          input_container: input_container,\n          text: \"Save\",\n          on_click: function on_click() {\n            _this2.save_created_preset();\n          },\n          id: \"save-preset-button\"\n        });\n\n        _btn2.generate_dom();\n\n        this.button_url = _btn2;\n      }\n    }\n  }, {\n    key: \"save_created_preset\",\n    value: function save_created_preset() {\n      var preset_selected = this.preset_selected;\n      assert(preset_selected.is_creator_preset, preset_selected);\n      var preset_name = this.name_option.input_value;\n\n      if (!preset_name) {\n        alert(\"You need to provide a name for your \" + this.preset_concept_name + \" in order to save it.\");\n        return;\n      }\n\n      var preset_id = NameIdConverter.from_name_to_id(preset_name);\n\n      if (this.preset_list.get_preset_by_name(preset_id, {\n        can_be_null: true\n      })) {\n        var error_msg = \"Change the name of your \" + this.preset_concept_name + \"; \" + \"you already have a \" + this.preset_concept_name + ' saved with ID \"' + preset_id + '\". (IDs are genrated from name; change name to change ID.)';\n        alert(error_msg);\n        return;\n      }\n\n      var preset_values = {};\n      this.option_list.filter(function (option) {\n        return option.is_creator_option;\n      }).forEach(function (option) {\n        var preset_val = option.input_value;\n        assert([false, \"\"].includes(preset_val) || preset_val, option.option_id, preset_val === undefined, {\n          preset_val: preset_val\n        });\n        preset_values[option.option_id] = preset_val;\n      });\n      var new_preset = new SavedPreset({\n        preset_id: preset_id,\n        preset_values: preset_values,\n        tab_settings: this\n      });\n      this.preset_list.save_preset(new_preset);\n      this.select_preset(new_preset);\n      this.reset_creator();\n    }\n  }, {\n    key: \"reset_creator\",\n    value: function reset_creator() {\n      // Erase all custom option values\n      this.option_list.forEach(function (option) {\n        option.reset();\n      });\n    }\n  }, {\n    key: \"copy_to_creator\",\n    value: function copy_to_creator() {\n      var _this3 = this;\n\n      var preset = this.active_preset;\n      assert(preset.is_real_preset);\n      var preset_values = preset.preset_values;\n\n      var _loop = function _loop(opt_id) {\n        var opt_val = preset_values[opt_id];\n        assert(![\"preset_name\", \"preset_id\", \"id\", \"name\"].includes(opt_val));\n\n        _this3.find_option(function (option) {\n          return option.option_id === opt_id;\n        }).set_input_value(opt_val);\n      };\n\n      for (var opt_id in preset_values) {\n        _loop(opt_id);\n      }\n\n      this.select_preset_creator();\n    }\n  }, {\n    key: \"modify_preset\",\n    value: function modify_preset() {\n      var preset = this.active_preset;\n      assert(preset.is_real_preset, preset);\n      var new_preset_id = this.preset_list.generate_unique_preset_id_copy(preset);\n      this.copy_to_creator();\n      this.name_option.set_input_value(NameIdConverter.from_id_to_name(new_preset_id));\n    }\n  }, {\n    key: \"delete_preset\",\n    value: function delete_preset() {\n      var preset = this.active_preset;\n      assert(preset.is_saved_preset, preset);\n      this.copy_to_creator();\n      this.name_option.set_input_value(preset.preset_name);\n      this.preset_list.remove_preset(preset);\n    }\n  }, {\n    key: \"global_side_effects\",\n    value: function global_side_effects() {\n      var _this4 = this;\n\n      var _ref5 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref5$is_initial_run = _ref5.is_initial_run,\n          is_initial_run = _ref5$is_initial_run === void 0 ? false : _ref5$is_initial_run;\n\n      if (is_initial_run) {\n        this.run_side_effects(true);\n        return;\n      }\n\n      if (_classPrivateFieldLooseBase(this, _global_side_effects__timeout)[_global_side_effects__timeout]) {\n        return;\n      }\n\n      _classPrivateFieldLooseBase(this, _global_side_effects__timeout)[_global_side_effects__timeout] = requestAnimationFrame(function () {\n        _this4.run_side_effects();\n\n        _classPrivateFieldLooseBase(_this4, _global_side_effects__timeout)[_global_side_effects__timeout] = null;\n      });\n    }\n  }, {\n    key: \"run_side_effects\",\n    value: function run_side_effects() {\n      var _this5 = this;\n\n      var is_initial_run = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      this.update_background();\n\n      if (this.text_container) {\n        this.update_font();\n        this.load_font_list();\n      }\n\n      this.update_option_visibility();\n      this.update_button_visibility();\n      this.on_any_change({\n        is_initial_run: is_initial_run\n      });\n      this.update_share_link();\n      this.update_save_block();\n\n      if (is_initial_run) {\n        this.load_preset_from_url();\n        window.addEventListener(\"hashchange\", function () {\n          return _this5.load_preset_from_url();\n        }, {\n          passive: true\n        });\n        this.track_user_presets();\n        this.set_options_container_visibility();\n      }\n    }\n  }, {\n    key: \"set_options_container_visibility\",\n    value: function set_options_container_visibility() {\n      var to_hide = this.option_list.every(function (opt) {\n        assert(opt.is_creator_option.constructor === Boolean);\n        return opt.is_creator_option || opt.is_preset_selector;\n      });\n\n      if (to_hide) {\n        this.options_container.style.display = \"none\";\n      }\n    }\n  }, {\n    key: \"track_user_presets\",\n    value: function track_user_presets() {\n      track_event({\n        name: \"preset_used\",\n        value: this.preset_selected.preset_id + \" \" + this.preset_concept_name.toLowerCase()\n      });\n    }\n  }, {\n    key: \"update_share_link\",\n    value: function update_share_link() {\n      var preset_selected = this.preset_selected;\n\n      if (!preset_selected.is_saved_preset) {\n        this.share_container.classList.add(\"no-share-link\");\n        return;\n      } else {\n        this.share_container.classList.remove(\"no-share-link\");\n      }\n\n      var current_link = preset_selected.share_link;\n\n      if (_classPrivateFieldLooseBase(this, _previous_link)[_previous_link] === current_link) {\n        return;\n      } else {\n        _classPrivateFieldLooseBase(this, _previous_link)[_previous_link] = current_link;\n      }\n\n      if (!_classPrivateFieldLooseBase(this, _link_el)[_link_el]) {\n        _classPrivateFieldLooseBase(this, _link_el)[_link_el] = document.createElement(\"a\");\n        _classPrivateFieldLooseBase(this, _link_el)[_link_el].id = \"share-link-tag\"; // this.#link_el.setAttribute('target', '_blank');\n\n        this.share_content.appendChild(_classPrivateFieldLooseBase(this, _link_el)[_link_el]);\n      }\n\n      _classPrivateFieldLooseBase(this, _link_el)[_link_el].setAttribute(\"href\", current_link);\n\n      _classPrivateFieldLooseBase(this, _link_el)[_link_el].textContent = current_link;\n    }\n  }, {\n    key: \"update_save_block\",\n    value: function update_save_block() {\n      this.save_container.style.display = this.preset_selected.is_creator_preset ? \"\" : \"none\";\n    }\n  }, {\n    key: \"load_preset_from_url\",\n    value: function load_preset_from_url() {\n      var preset_url = window.location.href;\n      var preset_data = LinkSerializer.from_url();\n\n      if (preset_data === null) {\n        return;\n      }\n\n      var preset_id = preset_data.preset_id;\n      assert(preset_id);\n      var preset_conflict = this.preset_list.get_preset_by_name(preset_id, {\n        can_be_null: true\n      });\n\n      if (preset_conflict) {\n        this.select_preset(preset_conflict);\n        show_toast(this.preset_concept_name + ' \"' + preset_conflict.preset_name + '\" already saved.');\n        remove_hash();\n        return;\n      }\n\n      var subapp_id = preset_data.subapp_id;\n      assert(subapp_id);\n      /* TN2\n      const wrong_url_format =\n      if( wrong_url_format ){\n        alert(\"URL is incorrect, maybe you inadvertently modified the URL?\");\n      }\n      */\n\n      var wrong_app = subapp_id !== this.subapp_id;\n\n      if (wrong_app) {\n        alert(\"Wrong app: the URL hash should be loaded in a different app.\");\n        return;\n      }\n\n      var preset_values = preset_data.preset_values;\n      assert(preset_values);\n      var new_preset = new SavedPreset({\n        preset_id: preset_id,\n        preset_values: preset_values,\n        tab_settings: this\n      });\n      this.preset_list.save_preset(new_preset);\n      this.select_preset(new_preset);\n      show_toast(this.preset_concept_name + ' \"' + new_preset.preset_name + '\" successfully saved.');\n      remove_hash();\n      track_event({\n        name: \"preset_imported\",\n        value: this.preset_concept_name + \" \" + new_preset.preset_name,\n        data: {\n          preset_url: preset_url\n        }\n      });\n    }\n  }, {\n    key: \"update_background\",\n    value: function update_background() {\n      var image = this.current_backgroud_image;\n      var color = this.current_backgroud_color; // set_background(color, image, \"#fv_right-side\");\n\n      set_background(color, image, \"body\");\n    }\n  }, {\n    key: \"update_font\",\n    value: function () {\n      var _update_font = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _this6 = this;\n\n        var text_container, get_font_name;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                text_container = this.text_container;\n\n                get_font_name = function get_font_name() {\n                  return _this6.current_font_name;\n                };\n\n                _context.next = 4;\n                return load_text_font({\n                  text_container: text_container,\n                  get_font_name: get_font_name\n                });\n\n              case 4:\n                this.on_font_change();\n                this.resolve_font_loaded_promise();\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function update_font() {\n        return _update_font.apply(this, arguments);\n      }\n\n      return update_font;\n    }()\n  }, {\n    key: \"update_option_visibility\",\n    value: function update_option_visibility() {\n      var _this7 = this;\n\n      // Visibility of options\n      var get_input_val = function get_input_val(dep_option_id) {\n        return _this7.find_option(function (option) {\n          return option.option_id === dep_option_id;\n        }).input_value;\n      };\n\n      this.option_list.forEach(function (opt) {\n        var to_hide = opt.option_dependency && !get_input_val(opt.option_dependency) || opt.is_creator_option && !_this7.preset_selected.is_creator_preset;\n\n        if (to_hide) {\n          opt.hide();\n        } else {\n          opt.show();\n        }\n      });\n    }\n  }, {\n    key: \"update_button_visibility\",\n    value: function update_button_visibility() {\n      if (!this.enable_import_export) {\n        return;\n      }\n\n      if (this.preset_selected.is_saved_preset) {\n        this.button_del.show();\n      } else {\n        this.button_del.hide();\n      }\n\n      if (this.preset_selected.is_creator_preset) {\n        this.button_mod.hide();\n        this.button_url.show();\n        this.name_option.show(); // this.button_del.hide();\n      } else {\n        this.button_url.hide();\n        this.name_option.hide(); // this.button_del.hide();\n\n        if (!this.preset_selected.is_randomizer_preset) {\n          this.button_mod.show();\n        } else {\n          this.button_mod.hide();\n        }\n      }\n    }\n  }, {\n    key: \"load_font_list\",\n    value: function () {\n      var _load_font_list2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.preset_selected.is_creator_preset) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 2:\n                if (!_classPrivateFieldLooseBase(this, _font_list_already_loading)[_font_list_already_loading]) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 4:\n                _classPrivateFieldLooseBase(this, _font_list_already_loading)[_font_list_already_loading] = true;\n                _context2.t0 = this.font_option;\n                _context2.t1 = [SelectInput.get_divider()];\n                _context2.t2 = _toConsumableArray;\n                _context2.next = 10;\n                return _load_font_list();\n\n              case 10:\n                _context2.t3 = _context2.sent;\n                _context2.t4 = (0, _context2.t2)(_context2.t3);\n                _context2.t5 = _context2.t1.concat.call(_context2.t1, _context2.t4);\n\n                _context2.t0.add_fonts.call(_context2.t0, _context2.t5);\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function load_font_list() {\n        return _load_font_list2.apply(this, arguments);\n      }\n\n      return load_font_list;\n    }()\n  }, {\n    key: \"find_option\",\n    value: function find_option(match) {\n      var option = this.option_list.find(match);\n      assert(option);\n      return option;\n    }\n  }, {\n    key: \"select_preset_creator\",\n    value: function select_preset_creator() {\n      this.active_preset = this.preset_list.creator_preset;\n    }\n  }, {\n    key: \"select_preset\",\n    value: function select_preset(preset) {\n      this.active_preset = preset;\n    }\n  }, {\n    key: \"get_option_value\",\n    value: function get_option_value(option_id) {\n      return this.find_option(function (option) {\n        return option.option_id === option_id;\n      }).active_value;\n    }\n  }, {\n    key: \"background_image_option\",\n    get: function get() {\n      return this.find_option(function (option) {\n        return option.is_background_image_option;\n      });\n    }\n  }, {\n    key: \"current_backgroud_image\",\n    get: function get() {\n      return this.background_image_option.active_value;\n    }\n  }, {\n    key: \"background_color_option\",\n    get: function get() {\n      return this.find_option(function (option) {\n        return option.is_background_color_option;\n      });\n    }\n  }, {\n    key: \"current_backgroud_color\",\n    get: function get() {\n      return this.background_color_option.active_value;\n    }\n  }, {\n    key: \"font_option\",\n    get: function get() {\n      return this.find_option(function (option) {\n        return option.is_font_option;\n      });\n    }\n  }, {\n    key: \"current_font_name\",\n    get: function get() {\n      return this.font_option.active_value;\n    }\n  }, {\n    key: \"active_preset\",\n    get: function get() {\n      var active_preset;\n      var preset_selected = this.preset_selected;\n\n      if (preset_selected.is_randomizer_preset) {\n        active_preset = preset_selected.random_preset;\n      } else {\n        active_preset = preset_selected;\n      }\n\n      assert(!active_preset.is_randomizer_preset, {\n        active_preset: active_preset\n      });\n      assert(active_preset.preset_id, {\n        active_preset: active_preset\n      });\n      return active_preset;\n    },\n    set: function set(preset_thing) {\n      var preset_id;\n\n      if (preset_thing.constructor === String) {\n        preset_id = preset_thing;\n      }\n\n      if (preset_thing instanceof Preset || preset_thing instanceof FakePreset) {\n        preset_id = preset_thing.preset_id;\n      }\n\n      assert(preset_id, {\n        preset_thing: preset_thing,\n        preset_id: preset_id\n      });\n      this.preset_option.set_input_value(preset_id);\n    }\n  }, {\n    key: \"preset_selected\",\n    get: function get() {\n      var preset_id = this.preset_option.input_value;\n      var preset = this.preset_list.get_preset_by_name(preset_id, {\n        can_be_null: true\n      });\n\n      if (preset) {\n        return preset;\n      }\n\n      var default_preset_id = this.preset_option.option_default;\n      assert(default_preset_id, {\n        default_preset_id: default_preset_id\n      });\n      var default_preset = this.preset_list.get_preset_by_name(default_preset_id);\n      return default_preset;\n    }\n  }, {\n    key: \"preset_option\",\n    get: function get() {\n      return this.find_option(function (option) {\n        return option.is_preset_selector;\n      });\n    }\n  }]);\n\n  return TabSettings;\n}();\n\nvar _global_side_effects__timeout = _classPrivateFieldLooseKey(\"global_side_effects__timeout\");\n\nvar _previous_link = _classPrivateFieldLooseKey(\"previous_link\");\n\nvar _link_el = _classPrivateFieldLooseKey(\"link_el\");\n\nvar _font_list_already_loading = _classPrivateFieldLooseKey(\"font_list_already_loading\");\n\nvar Option = /*#__PURE__*/function () {\n  function Option(_ref6) {\n    var _this8 = this;\n\n    var option_id = _ref6.option_id,\n        option_description = _ref6.option_description,\n        option_default = _ref6.option_default,\n        input_width = _ref6.input_width,\n        tab_settings = _ref6.tab_settings,\n        input_container = _ref6.input_container,\n        _ref6$is_creator_opti = _ref6.is_creator_option,\n        is_creator_option = _ref6$is_creator_opti === void 0 ? false : _ref6$is_creator_opti,\n        props = _objectWithoutProperties(_ref6, [\"option_id\", \"option_description\", \"option_default\", \"input_width\", \"tab_settings\", \"input_container\", \"is_creator_option\"]);\n\n    _classCallCheck(this, Option);\n\n    this.tab_settings = void 0;\n    this.option_id = void 0;\n    this.option_description = void 0;\n    this.input_args = void 0;\n    this.is_creator_option = void 0;\n    this.option_default = void 0;\n    this.user_input = void 0;\n    assert(option_id);\n    assert(tab_settings);\n    Object.assign(this, _objectSpread({\n      option_id: option_id,\n      tab_settings: tab_settings\n    }, props));\n    this.is_creator_option = is_creator_option;\n    this.option_default = option_default;\n    input_container = input_container || (is_creator_option ? this.tab_settings.creator_content : this.tab_settings.options_content);\n    assert(input_container, {\n      option_id: option_id\n    });\n    this.input_args = {\n      input_id: option_id,\n      input_description: option_description,\n      on_input_change: function on_input_change() {\n        _this8.tab_settings.global_side_effects();\n      },\n      input_default: option_default,\n      input_container: input_container,\n      input_width: input_width\n    };\n  }\n\n  _createClass(Option, [{\n    key: \"generate_dom\",\n    value: function generate_dom() {\n      if (this.before_dom) {\n        this.before_dom();\n      }\n\n      assert(this.user_input);\n      this.user_input.init();\n    }\n  }, {\n    key: \"set_input_value\",\n    value: function set_input_value(val) {\n      this.user_input.input_set(val);\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      this.user_input.hide();\n    }\n  }, {\n    key: \"show\",\n    value: function show() {\n      this.user_input.show();\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {// TODO\n    }\n  }, {\n    key: \"input_value\",\n    get: function get() {\n      return this.user_input.input_get();\n    }\n  }, {\n    key: \"preset_value\",\n    get: function get() {\n      var preset_val = this.tab_settings.active_preset.get_preset_value(this);\n      return preset_val;\n    }\n  }, {\n    key: \"active_value\",\n    get: function get() {\n      if (this.tab_settings.preset_selected.is_creator_preset) {\n        return this.input_value;\n      }\n\n      var preset_value = this.preset_value;\n\n      if (this.is_creator_option) {\n        return preset_value;\n      }\n\n      if (preset_value !== null) {\n        return preset_value;\n      }\n\n      return this.input_value;\n    }\n  }]);\n\n  return Option;\n}();\n\nvar DateOption = /*#__PURE__*/function (_Option) {\n  _inherits(DateOption, _Option);\n\n  function DateOption(args) {\n    var _this9;\n\n    _classCallCheck(this, DateOption);\n\n    _this9 = _possibleConstructorReturn(this, _getPrototypeOf(DateOption).call(this, args));\n    _this9.user_input = new DateInput(_this9.input_args);\n    return _this9;\n  }\n\n  return DateOption;\n}(Option);\n\nvar BooleanOption = /*#__PURE__*/function (_Option2) {\n  _inherits(BooleanOption, _Option2);\n\n  function BooleanOption(args) {\n    var _this10;\n\n    _classCallCheck(this, BooleanOption);\n\n    _this10 = _possibleConstructorReturn(this, _getPrototypeOf(BooleanOption).call(this, args));\n    _this10.user_input = new BooleanInput(_this10.input_args);\n    return _this10;\n  }\n\n  return BooleanOption;\n}(Option);\n\nvar SelectOption = /*#__PURE__*/function (_Option3) {\n  _inherits(SelectOption, _Option3);\n\n  function SelectOption(args, input_options) {\n    var _this11;\n\n    _classCallCheck(this, SelectOption);\n\n    _this11 = _possibleConstructorReturn(this, _getPrototypeOf(SelectOption).call(this, args));\n    _this11.user_input = void 0;\n    _this11.user_input = new SelectInput(_objectSpread({\n      input_options: input_options\n    }, _this11.input_args));\n    return _this11;\n  }\n\n  _createClass(SelectOption, [{\n    key: \"add_options\",\n    value: function add_options(args) {\n      this.user_input.add_options(args);\n    }\n  }]);\n\n  return SelectOption;\n}(Option);\n\nvar ChoiceOption = /*#__PURE__*/function (_SelectOption) {\n  _inherits(ChoiceOption, _SelectOption);\n\n  function ChoiceOption(_ref7) {\n    var option_choices = _ref7.option_choices,\n        args = _objectWithoutProperties(_ref7, [\"option_choices\"]);\n\n    _classCallCheck(this, ChoiceOption);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ChoiceOption).call(this, _objectSpread({\n      input_width: \"100px\"\n    }, args), option_choices));\n  }\n\n  return ChoiceOption;\n}(SelectOption);\n\nvar TextOption = /*#__PURE__*/function (_Option4) {\n  _inherits(TextOption, _Option4);\n\n  function TextOption(args) {\n    var _this12;\n\n    _classCallCheck(this, TextOption);\n\n    _this12 = _possibleConstructorReturn(this, _getPrototypeOf(TextOption).call(this, args));\n    _this12.input_args.input_placeholder = args.option_placeholder;\n    _this12.user_input = new TextInput(_this12.input_args);\n    return _this12;\n  }\n\n  return TextOption;\n}(Option);\n/*\nclass TextOption extends Option {\n  constructor({option_placeholder, ...args}) {\n    super(args);\n    this.input_args.input_placeholder = option_placeholder;\n    this.user_input = new TextInput(this.input_args);\n  }\n}\n*/\n\n\nvar ColorOption = /*#__PURE__*/function (_Option5) {\n  _inherits(ColorOption, _Option5);\n\n  function ColorOption(args) {\n    var _this13;\n\n    _classCallCheck(this, ColorOption);\n\n    _this13 = _possibleConstructorReturn(this, _getPrototypeOf(ColorOption).call(this, _objectSpread({\n      input_width: \"35px\"\n    }, args)));\n    _this13.user_input = new ColorInput(_this13.input_args);\n    return _this13;\n  }\n\n  return ColorOption;\n}(Option);\n\nvar TextColorOption = /*#__PURE__*/function (_ColorOption) {\n  _inherits(TextColorOption, _ColorOption);\n\n  function TextColorOption() {\n    _classCallCheck(this, TextColorOption);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(TextColorOption).apply(this, arguments));\n  }\n\n  return TextColorOption;\n}(ColorOption);\n\nvar TextShadowOption = /*#__PURE__*/function (_TextOption) {\n  _inherits(TextShadowOption, _TextOption);\n\n  function TextShadowOption() {\n    _classCallCheck(this, TextShadowOption);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(TextShadowOption).apply(this, arguments));\n  }\n\n  return TextShadowOption;\n}(TextOption);\n\nvar PresetOption = /*#__PURE__*/function (_SelectOption2) {\n  _inherits(PresetOption, _SelectOption2);\n\n  function PresetOption(_ref8) {\n    var _this14;\n\n    var input_options = _ref8.input_options,\n        args = _objectWithoutProperties(_ref8, [\"input_options\"]);\n\n    _classCallCheck(this, PresetOption);\n\n    _this14 = _possibleConstructorReturn(this, _getPrototypeOf(PresetOption).call(this, _objectSpread({\n      input_width: \"120px\",\n      input_container: args.tab_settings.creator_content\n    }, args), input_options));\n    _this14.is_preset_selector = true;\n    return _this14;\n  }\n\n  _createClass(PresetOption, [{\n    key: \"before_dom\",\n    value: function before_dom() {\n      this.user_input.input_options = this.get_input_options();\n    }\n  }, {\n    key: \"refresh\",\n    value: function refresh() {\n      this.before_dom();\n      this.user_input.refresh();\n    }\n  }, {\n    key: \"get_input_options\",\n    value: function get_input_options() {\n      var _this$tab_settings$pr = this.tab_settings.preset_list.presets_ordered,\n          special_ones = _this$tab_settings$pr.special_ones,\n          saved_ones = _this$tab_settings$pr.saved_ones,\n          native_ones = _this$tab_settings$pr.native_ones;\n      {\n        var map = function map(_ref9) {\n          var preset_id = _ref9.preset_id,\n              preset_name = _ref9.preset_name;\n          assert(preset_id);\n          assert(preset_name);\n          return {\n            val: preset_id,\n            val_pretty: preset_name\n          };\n        };\n\n        special_ones = special_ones.map(map);\n        saved_ones = saved_ones.map(map);\n        native_ones = native_ones.map(map);\n      }\n      return saved_ones.length > 0 ? [].concat(_toConsumableArray(special_ones), [SelectInput.get_divider(\"Saved\")], _toConsumableArray(saved_ones), [SelectInput.get_divider(\"Native\")], _toConsumableArray(native_ones)) : [].concat(_toConsumableArray(special_ones), [SelectInput.get_divider()], _toConsumableArray(native_ones));\n    }\n  }]);\n\n  return PresetOption;\n}(SelectOption);\n\nvar BackgroundImageOption = /*#__PURE__*/function (_TextOption2) {\n  _inherits(BackgroundImageOption, _TextOption2);\n\n  function BackgroundImageOption() {\n    var _getPrototypeOf2;\n\n    var _this15;\n\n    _classCallCheck(this, BackgroundImageOption);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this15 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(BackgroundImageOption)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this15.is_background_image_option = true;\n    return _this15;\n  }\n\n  return BackgroundImageOption;\n}(TextOption);\n\nvar BackgroundColorOption = /*#__PURE__*/function (_ColorOption2) {\n  _inherits(BackgroundColorOption, _ColorOption2);\n\n  function BackgroundColorOption() {\n    var _getPrototypeOf3;\n\n    var _this16;\n\n    _classCallCheck(this, BackgroundColorOption);\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    _this16 = _possibleConstructorReturn(this, (_getPrototypeOf3 = _getPrototypeOf(BackgroundColorOption)).call.apply(_getPrototypeOf3, [this].concat(args)));\n    _this16.is_background_color_option = true;\n    return _this16;\n  }\n\n  return BackgroundColorOption;\n}(ColorOption);\n\nvar FontOption = /*#__PURE__*/function (_SelectOption3) {\n  _inherits(FontOption, _SelectOption3);\n\n  function FontOption(_ref10) {\n    var _this17;\n\n    var input_optoins = _ref10.input_optoins,\n        args = _objectWithoutProperties(_ref10, [\"input_optoins\"]);\n\n    _classCallCheck(this, FontOption);\n\n    _this17 = _possibleConstructorReturn(this, _getPrototypeOf(FontOption).call(this, _objectSpread({\n      input_width: \"110px\"\n    }, args), input_optoins));\n    _this17.is_font_option = true;\n    return _this17;\n  }\n\n  _createClass(FontOption, [{\n    key: \"before_dom\",\n    value: function before_dom() {\n      this.user_input.input_options = this.tab_settings.preset_list.get_all_preset_fonts();\n    }\n  }, {\n    key: \"add_fonts\",\n    value: function add_fonts(args) {\n      this.add_options(args);\n    }\n  }, {\n    key: \"input_value\",\n    get: function get() {\n      var val = _get(_getPrototypeOf(FontOption.prototype), \"input_value\", this);\n\n      assert(val, \"empty_font_value\", val === undefined, val === \"\", {\n        val: val\n      });\n      return val;\n    }\n  }]);\n\n  return FontOption;\n}(SelectOption);\n\nfunction load_text_font(_x) {\n  return _load_text_font.apply(this, arguments);\n}\n\nfunction _load_text_font() {\n  _load_text_font = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(_ref21) {\n    var text_container, get_font_name, font_name;\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            text_container = _ref21.text_container, get_font_name = _ref21.get_font_name;\n            font_name = get_font_name();\n            _context3.next = 4;\n            return load_font(font_name);\n\n          case 4:\n            if (!(font_name !== get_font_name())) {\n              _context3.next = 6;\n              break;\n            }\n\n            return _context3.abrupt(\"return\");\n\n          case 6:\n            if (!(font_name === text_container.style.fontFamily)) {\n              _context3.next = 8;\n              break;\n            }\n\n            return _context3.abrupt(\"return\");\n\n          case 8:\n            text_container.style.fontFamily = font_name;\n\n          case 9:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _load_text_font.apply(this, arguments);\n}\n\nfunction instantiate_options(_ref11) {\n  var tab_settings = _ref11.tab_settings,\n      option_spec_list = _ref11.option_spec_list;\n  return option_spec_list.map(function (_ref12) {\n    var option_type = _ref12.option_type,\n        option_spec = _objectWithoutProperties(_ref12, [\"option_type\"]);\n\n    assert(option_spec.option_id, option_spec);\n\n    var args = _objectSpread({}, option_spec, {\n      tab_settings: tab_settings\n    });\n\n    if (option_type === \"text-font-input\") {\n      return new FontOption(args);\n    }\n\n    if (option_type === \"preset-input\") {\n      return new PresetOption(args);\n    }\n\n    if (option_type === \"text-color-input\") {\n      return new TextColorOption(args);\n    }\n\n    if (option_type === \"color-input\") {\n      return new ColorOption(args);\n    }\n\n    if (option_type === \"text-shadow-input\") {\n      return new TextShadowOption(args);\n    }\n\n    if (option_type === \"text-input\") {\n      return new TextOption(args);\n    }\n\n    if (option_type === \"background-image-input\") {\n      return new BackgroundImageOption(args);\n    }\n\n    if (option_type === \"background-color-input\") {\n      return new BackgroundColorOption(args);\n    }\n\n    if (option_type === \"boolean-input\") {\n      return new BooleanOption(args);\n    }\n\n    if (option_type === \"date-input\") {\n      return new DateOption(args);\n    }\n\n    if (option_type === \"choice-input\") {\n      return new ChoiceOption(args);\n    }\n\n    assert(false, {\n      option_type: option_type\n    });\n  });\n}\n\nvar PresetList = /*#__PURE__*/function () {\n  function PresetList(_ref13) {\n    var preset_spec_list = _ref13.preset_spec_list,\n        tab_settings = _ref13.tab_settings;\n\n    _classCallCheck(this, PresetList);\n\n    Object.defineProperty(this, _preset_savior, {\n      writable: true,\n      value: null\n    });\n    Object.defineProperty(this, _native_presets, {\n      writable: true,\n      value: null\n    });\n    this.tab_settings = void 0;\n    this.randomizer_preset = void 0;\n    this.creator_preset = void 0;\n    this.tab_settings = tab_settings;\n    _classPrivateFieldLooseBase(this, _preset_savior)[_preset_savior] = new PresetSavior({\n      subapp_id: tab_settings.subapp_id\n    });\n\n    if (!this.tab_settings.no_random_preset) {\n      this.randomizer_preset = new RandomizerPreset({\n        preset_list: this\n      });\n    }\n\n    this.creator_preset = new CreatorPreset();\n    _classPrivateFieldLooseBase(this, _native_presets)[_native_presets] = Object.entries(preset_spec_list).map(function (_ref14) {\n      var _ref15 = _slicedToArray(_ref14, 2),\n          preset_id = _ref15[0],\n          preset_values = _ref15[1];\n\n      return new NativePreset({\n        preset_id: preset_id,\n        preset_values: preset_values,\n        tab_settings: tab_settings\n      });\n    });\n  }\n\n  _createClass(PresetList, [{\n    key: \"save_preset\",\n    value: function save_preset(preset) {\n      _classPrivateFieldLooseBase(this, _preset_savior)[_preset_savior].save_preset(preset);\n\n      this.refresh_user_input();\n    }\n  }, {\n    key: \"remove_preset\",\n    value: function remove_preset(preset) {\n      _classPrivateFieldLooseBase(this, _preset_savior)[_preset_savior].remove_preset(preset);\n\n      this.refresh_user_input();\n    }\n  }, {\n    key: \"refresh_user_input\",\n    value: function refresh_user_input() {\n      this.tab_settings.preset_option.refresh();\n    }\n  }, {\n    key: \"_get_saved_presets\",\n    value: function _get_saved_presets() {\n      var tab_settings = this.tab_settings;\n      return _classPrivateFieldLooseBase(this, _preset_savior)[_preset_savior].get_saved_presets().map(function (_ref16) {\n        var preset_id = _ref16.preset_id,\n            preset_values = _ref16.preset_values;\n        return new SavedPreset({\n          preset_id: preset_id,\n          preset_values: preset_values,\n          tab_settings: tab_settings\n        });\n      });\n    }\n  }, {\n    key: \"get_preset_by_name\",\n    value: function get_preset_by_name(preset_id) {\n      var _ref17 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          _ref17$can_be_null = _ref17.can_be_null,\n          can_be_null = _ref17$can_be_null === void 0 ? false : _ref17$can_be_null;\n\n      assert(preset_id);\n\n      var presets = this._get_all_presets();\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = presets[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var preset = _step.value;\n\n          if (preset.preset_id === preset_id) {\n            return preset;\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n            _iterator[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      assert(can_be_null, \"Could not find preset\", {\n        preset_id: preset_id\n      });\n    }\n  }, {\n    key: \"get_all_preset_fonts\",\n    value: function get_all_preset_fonts() {\n      var _this$presets_ordered = this.presets_ordered,\n          saved_ones = _this$presets_ordered.saved_ones,\n          native_ones = _this$presets_ordered.native_ones;\n      var presets = [].concat(_toConsumableArray(saved_ones), _toConsumableArray(native_ones));\n      presets.forEach(function (preset) {\n        return assert(preset.is_real_preset, preset.preset_id);\n      });\n      var preset_font_names = presets.map(function (preset) {\n        var font_name = preset.preset_font_name;\n        assert(font_name, preset.preset_id);\n        return font_name;\n      });\n      preset_font_names = make_unique(preset_font_names);\n      return preset_font_names;\n    }\n  }, {\n    key: \"generate_unique_preset_id_copy\",\n    value: function generate_unique_preset_id_copy(preset) {\n      var preset_ids = this._get_all_preset_ids();\n\n      var preset_id = preset.preset_id;\n      assert(preset_id);\n      var s = NameIdConverter.white_space_seralized;\n      assert(s);\n      var base = preset_id.split(\"_\").join(s).split(/-edit(-|$)/)[0] + s + \"edit\";\n\n      for (var _i2 = 1; _i2 < 100; _i2++) {\n        var candidate = base + (_i2 === 1 ? \"\" : s + _i2);\n\n        if (!preset_ids.includes(candidate)) {\n          return candidate;\n        }\n      }\n\n      assert(false);\n    }\n  }, {\n    key: \"_get_all_preset_ids\",\n    value: function _get_all_preset_ids() {\n      var presets = this._get_all_presets();\n\n      var preset_ids = presets.map(function (preset) {\n        return preset.preset_id;\n      });\n      return preset_ids;\n    }\n  }, {\n    key: \"_get_all_presets\",\n    value: function _get_all_presets() {\n      var _this$presets_ordered2 = this.presets_ordered,\n          special_ones = _this$presets_ordered2.special_ones,\n          saved_ones = _this$presets_ordered2.saved_ones,\n          native_ones = _this$presets_ordered2.native_ones;\n      var presets = [].concat(_toConsumableArray(special_ones), _toConsumableArray(saved_ones), _toConsumableArray(native_ones));\n      return presets;\n    }\n  }, {\n    key: \"random_candidates\",\n    get: function get() {\n      var _this$presets_ordered3 = this.presets_ordered,\n          saved_ones = _this$presets_ordered3.saved_ones,\n          native_ones = _this$presets_ordered3.native_ones;\n\n      if (saved_ones.length > 1) {\n        return saved_ones;\n      }\n\n      return native_ones;\n    }\n  }, {\n    key: \"presets_ordered\",\n    get: function get() {\n      var special_ones = [this.creator_preset];\n\n      if (this.randomizer_preset) {\n        special_ones.push(this.randomizer_preset);\n      }\n\n      var saved_ones = this._get_saved_presets();\n\n      var native_ones = _classPrivateFieldLooseBase(this, _native_presets)[_native_presets];\n\n      assert(special_ones && saved_ones && native_ones);\n      return {\n        special_ones: special_ones,\n        saved_ones: saved_ones,\n        native_ones: native_ones\n      };\n    }\n  }]);\n\n  return PresetList;\n}();\n\nvar _preset_savior = _classPrivateFieldLooseKey(\"preset_savior\");\n\nvar _native_presets = _classPrivateFieldLooseKey(\"native_presets\");\n\nvar PresetSerializer = /*#__PURE__*/function () {\n  function PresetSerializer() {\n    _classCallCheck(this, PresetSerializer);\n  }\n\n  _createClass(PresetSerializer, null, [{\n    key: \"serialize_preset\",\n    value: function serialize_preset(preset) {\n      assert(preset instanceof SavedPreset); // Validation\n\n      var preset_id = preset.preset_id,\n          preset_values = preset.preset_values;\n      var subapp_id = preset.tab_settings.subapp_id;\n      var preset_data = new PresetData({\n        preset_id: preset_id,\n        preset_values: preset_values,\n        subapp_id: subapp_id\n      });\n      var preset_string = serialize(preset_data);\n      return preset_string;\n    }\n  }, {\n    key: \"deserialize_preset\",\n    value: function deserialize_preset(preset_string) {\n      assert(preset_string.constructor === String);\n      var preset_data = deserialize(preset_string); // share URLs cannot be migrated thus we migrate here at runtime\n\n      if (preset_data.preset_name && !preset_data.preset_id && preset_data.preset_options && !preset_data.preset_values) {\n        preset_data.preset_id = preset_data.preset_name;\n        delete preset_data.preset_name;\n        preset_data.preset_values = preset_data.preset_options;\n        delete preset_data.preset_options;\n      }\n\n      if (preset_data.app_name && !preset_data.subapp_id) {\n        preset_data.subapp_id = preset_data.app_name;\n        delete preset_data.app_name;\n      }\n\n      preset_data = new PresetData(preset_data);\n      return preset_data;\n    }\n  }]);\n\n  return PresetSerializer;\n}();\n\nvar Preset = /*#__PURE__*/function () {\n  function Preset(_ref18) {\n    var preset_id = _ref18.preset_id,\n        preset_values = _ref18.preset_values,\n        tab_settings = _ref18.tab_settings;\n\n    _classCallCheck(this, Preset);\n\n    this.preset_id = void 0;\n    this.preset_values = void 0;\n    this.tab_settings = void 0;\n    this.is_randomizer_preset = false;\n    this.is_creator_preset = false;\n    assert(preset_id);\n    assert([Object, PresetValues].includes(preset_values.constructor));\n    assert(tab_settings);\n    this.preset_id = preset_id;\n    this.preset_values = preset_values;\n    this.tab_settings = tab_settings; // Abstract class\n\n    if ((this instanceof Preset ? this.constructor : void 0) === Preset) {\n      throw new TypeError(\"Cannot construct Preset instances directly.\");\n    }\n  }\n\n  _createClass(Preset, [{\n    key: \"get_preset_value\",\n    value: function get_preset_value(option) {\n      var option_id = option.option_id;\n      assert(option_id);\n      var preset_values = this.preset_values;\n\n      if (option_id in preset_values) {\n        var val = preset_values[option_id];\n        assert(val !== null);\n        return val;\n      }\n\n      return null;\n    }\n  }, {\n    key: \"is_real_preset\",\n    get: function get() {\n      return !this.is_randomizer_preset && !this.is_creator_preset;\n    }\n  }, {\n    key: \"preset_font_name\",\n    get: function get() {\n      var preset_font_name = this.get_preset_value(this.tab_settings.font_option);\n      assert(preset_font_name, {\n        preset_font_name: preset_font_name\n      });\n      return preset_font_name;\n    }\n  }, {\n    key: \"preset_name\",\n    get: function get() {\n      var prettified = NameIdConverter.from_id_to_name(this.preset_id);\n      assert(prettified, {\n        prettified: prettified\n      });\n      return prettified;\n    }\n  }]);\n\n  return Preset;\n}();\n\nvar SavedPreset = /*#__PURE__*/function (_Preset) {\n  _inherits(SavedPreset, _Preset);\n\n  function SavedPreset() {\n    var _getPrototypeOf4;\n\n    var _this18;\n\n    _classCallCheck(this, SavedPreset);\n\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    _this18 = _possibleConstructorReturn(this, (_getPrototypeOf4 = _getPrototypeOf(SavedPreset)).call.apply(_getPrototypeOf4, [this].concat(args)));\n    Object.defineProperty(_assertThisInitialized(_this18), _generated_link, {\n      writable: true,\n      value: null\n    });\n    return _this18;\n  }\n\n  _createClass(SavedPreset, [{\n    key: \"is_saved_preset\",\n    get: function get() {\n      return true;\n    }\n  }, {\n    key: \"share_link\",\n    get: function get() {\n      if (!_classPrivateFieldLooseBase(this, _generated_link)[_generated_link]) {\n        return _classPrivateFieldLooseBase(this, _generated_link)[_generated_link] = LinkSerializer.to_url(this);\n      }\n\n      return _classPrivateFieldLooseBase(this, _generated_link)[_generated_link];\n    }\n  }]);\n\n  return SavedPreset;\n}(Preset);\n\nvar _generated_link = _classPrivateFieldLooseKey(\"generated_link\");\n\nvar NativePreset = /*#__PURE__*/function (_Preset2) {\n  _inherits(NativePreset, _Preset2);\n\n  function NativePreset(args) {\n    var _this19;\n\n    _classCallCheck(this, NativePreset);\n\n    _this19 = _possibleConstructorReturn(this, _getPrototypeOf(NativePreset).call(this, args));\n    var preset_id = args.preset_id;\n    assert(!preset_id.includes(\"-\"), {\n      preset_id: preset_id\n    });\n    assert(/^[a-zA-Z0-9_]+$$/.test(preset_id), {\n      preset_id: preset_id\n    });\n    return _this19;\n  }\n\n  return NativePreset;\n}(Preset);\n\nvar PresetData = function PresetData(args) {\n  _classCallCheck(this, PresetData);\n\n  this.subapp_id = void 0;\n  this.preset_id = void 0;\n  this.preset_values = void 0;\n\n  // I don't know why but even after all migrations applied a user\n  // had a `preset_options` prop in its local storage.\n  if (args.preset_options && !args.preset_values) {\n    args.preset_values = args.preset_options;\n    delete args.preset_options;\n  }\n\n  var preset_id = args.preset_id,\n      preset_values = args.preset_values,\n      subapp_id = args.subapp_id,\n      rest = _objectWithoutProperties(args, [\"preset_id\", \"preset_values\", \"subapp_id\"]);\n\n  assert(Object.keys(rest).length === 0 && preset_id && preset_values && subapp_id, \"malformatted preset data\", args);\n  this.subapp_id = subapp_id;\n  this.preset_id = preset_id;\n  this.preset_values = new PresetValues(preset_values);\n};\n\nvar PresetValues = function PresetValues(args) {\n  _classCallCheck(this, PresetValues);\n\n  assert([Object, PresetValues].includes(args.constructor), args, args.constructor);\n  Object.assign(this, args);\n};\n\nvar PresetSavior = /*#__PURE__*/function () {\n  function PresetSavior(_ref19) {\n    var subapp_id = _ref19.subapp_id;\n\n    _classCallCheck(this, PresetSavior);\n\n    Object.defineProperty(this, _subapp_id, {\n      writable: true,\n      value: null\n    });\n    assert(subapp_id);\n    _classPrivateFieldLooseBase(this, _subapp_id)[_subapp_id] = subapp_id;\n  }\n\n  _createClass(PresetSavior, [{\n    key: \"get_saved_presets\",\n    value: function get_saved_presets() {\n      return this._get_presets();\n    }\n  }, {\n    key: \"save_preset\",\n    value: function save_preset(preset) {\n      var preset_id = preset.preset_id,\n          preset_values = preset.preset_values;\n      assert(preset_id);\n      assert(preset_values);\n\n      var presets = this._get_presets();\n\n      if (presets.find(function (preset) {\n        return preset.preset_id === preset_id;\n      })) {\n        // @ts-ignore\n        assert.warning(\"Trying to save \" + preset_id + \" but it is already saved.\");\n        return;\n      }\n\n      var subapp_id = _classPrivateFieldLooseBase(this, _subapp_id)[_subapp_id];\n\n      var preset_data = new PresetData({\n        preset_id: preset_id,\n        preset_values: preset_values,\n        subapp_id: subapp_id\n      });\n      presets.push(preset_data);\n\n      this._save_presets(presets);\n    }\n  }, {\n    key: \"remove_preset\",\n    value: function remove_preset(preset) {\n      var preset_id = preset.preset_id;\n      assert(preset_id);\n\n      var presets = this._get_presets();\n\n      var old_length = presets.length;\n      presets = presets.filter(function (preset) {\n        return preset.preset_id !== preset_id;\n      });\n      var new_length = presets.length;\n\n      if (new_length === old_length) {\n        // @ts-ignore\n        assert.warning(false, \"Preset \" + preset_id + \" not found.\");\n      }\n\n      if (new_length !== old_length - 1) {\n        // @ts-ignore\n        assert.warning(false, \"Preset \" + preset_id + \" found multiple times.\");\n      }\n\n      this._save_presets(presets);\n    }\n  }, {\n    key: \"_get_presets\",\n    value: function _get_presets() {\n      var presets = store.get_val(this._storage_key) || []; // Validation\n\n      assert(presets.constructor === Array);\n      presets = presets.map(function (preset_data) {\n        return new PresetData(preset_data);\n      });\n      return presets;\n    }\n  }, {\n    key: \"_save_presets\",\n    value: function _save_presets(presets) {\n      // Validation\n      assert(presets.constructor === Array);\n      presets.forEach(function (preset_data) {\n        assert(preset_data instanceof PresetData);\n      });\n      store.set_val(this._storage_key, presets);\n    }\n  }, {\n    key: \"_storage_key\",\n    get: function get() {\n      return _classPrivateFieldLooseBase(this, _subapp_id)[_subapp_id] + \"_presets\";\n    }\n  }]);\n\n  return PresetSavior;\n}();\n\nvar _subapp_id = _classPrivateFieldLooseKey(\"subapp_id\");\n\nvar FakePreset = /*#__PURE__*/function () {\n  function FakePreset() {\n    _classCallCheck(this, FakePreset);\n\n    this.is_randomizer_preset = void 0;\n    this.is_creator_preset = void 0;\n    this.preset_id = void 0;\n    this.preset_name = void 0;\n  }\n\n  _createClass(FakePreset, [{\n    key: \"get_preset_value\",\n    value: function get_preset_value() {\n      return null;\n    }\n  }]);\n\n  return FakePreset;\n}();\n\nvar RandomizerPreset = /*#__PURE__*/function (_FakePreset) {\n  _inherits(RandomizerPreset, _FakePreset);\n\n  function RandomizerPreset(_ref20) {\n    var _this20;\n\n    var preset_list = _ref20.preset_list;\n\n    _classCallCheck(this, RandomizerPreset);\n\n    _this20 = _possibleConstructorReturn(this, _getPrototypeOf(RandomizerPreset).call(this));\n    Object.defineProperty(_assertThisInitialized(_this20), _picked, {\n      writable: true,\n      value: null\n    });\n    _this20.is_randomizer_preset = true;\n    _this20.is_creator_preset = false;\n    _this20.preset_id = \"_random\";\n    _this20.preset_name = \"<Random>\";\n    _this20.preset_list = void 0;\n    _this20.is_randomizer_preset = true;\n    _this20.preset_list = preset_list;\n    return _this20;\n  }\n\n  _createClass(RandomizerPreset, [{\n    key: \"pick_random_preset\",\n    value: function pick_random_preset() {\n      var random_candidates = this.preset_list.random_candidates;\n      var idx = Math.floor(Math.random() * random_candidates.length);\n      return random_candidates[idx];\n    }\n  }, {\n    key: \"random_preset\",\n    get: function get() {\n      if (!_classPrivateFieldLooseBase(this, _picked)[_picked]) {\n        _classPrivateFieldLooseBase(this, _picked)[_picked] = this.pick_random_preset();\n      }\n\n      assert(_classPrivateFieldLooseBase(this, _picked)[_picked].is_real_preset, _classPrivateFieldLooseBase(this, _picked)[_picked].preset_id, _classPrivateFieldLooseBase(this, _picked)[_picked]);\n      return _classPrivateFieldLooseBase(this, _picked)[_picked];\n    }\n  }]);\n\n  return RandomizerPreset;\n}(FakePreset);\n\nvar _picked = _classPrivateFieldLooseKey(\"picked\");\n\nvar CreatorPreset = /*#__PURE__*/function (_FakePreset2) {\n  _inherits(CreatorPreset, _FakePreset2);\n\n  function CreatorPreset() {\n    var _getPrototypeOf5;\n\n    var _this21;\n\n    _classCallCheck(this, CreatorPreset);\n\n    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n\n    _this21 = _possibleConstructorReturn(this, (_getPrototypeOf5 = _getPrototypeOf(CreatorPreset)).call.apply(_getPrototypeOf5, [this].concat(args)));\n    _this21.is_randomizer_preset = false;\n    _this21.is_creator_preset = true;\n    _this21.preset_id = \"_creator\";\n    _this21.preset_name = \"<Creator>\";\n    return _this21;\n  }\n\n  return CreatorPreset;\n}(FakePreset);\n\nvar NameIdConverter = /*#__PURE__*/function () {\n  function NameIdConverter() {\n    _classCallCheck(this, NameIdConverter);\n  }\n\n  _createClass(NameIdConverter, null, [{\n    key: \"from_id_to_name\",\n    value: function from_id_to_name(id) {\n      assert(id);\n      var sep_regex = /[-_]/;\n      assert(\"--a-_-_--\".split(sep_regex).filter(Boolean).join(\"\") === \"a\");\n      var name = id.split(sep_regex).filter(Boolean).map(function (word) {\n        return word[0].toUpperCase() + word.slice(1);\n      }).join(\" \"); // console.log({id, name});\n\n      return name;\n    }\n  }, {\n    key: \"from_name_to_id\",\n    value: function from_name_to_id(name) {\n      assert(name);\n      var sep_regex = /[\\s-_]/;\n      assert(\"  -- a-  _-  _--\".split(sep_regex).filter(Boolean).join(\"\") === \"a\");\n      var id = name.split(sep_regex).filter(Boolean).join(NameIdConverter.white_space_seralized).toLowerCase(); // console.log({name, id});\n\n      return id;\n    }\n  }]);\n\n  return NameIdConverter;\n}();\n\nNameIdConverter.white_space_seralized = \"-\";\n\nfunction make_unique(arr) {\n  return Array.from(new Set(arr.filter(Boolean))).sort();\n} // TODO-later\n// What Preset values should be required before saving? What happens when the user sets some to ''?\n// TypeScript\n//  - Create a strict type for preset_id\n\n\nvar LinkSerializer = /*#__PURE__*/function () {\n  function LinkSerializer() {\n    _classCallCheck(this, LinkSerializer);\n  }\n\n  _createClass(LinkSerializer, null, [{\n    key: \"_to_base64\",\n    value: function _to_base64(str) {\n      var str__base64 = window.btoa(str);\n      assert(window.btoa(\"ab?\") === \"YWI/\");\n      str__base64 = str__base64.split(\"/\").join(\"_\");\n      assert(window.btoa(\"ab>\") === \"YWI+\");\n      str__base64 = str__base64.split(\"+\").join(\"-\");\n      return str__base64;\n    }\n  }, {\n    key: \"_from_base64\",\n    value: function _from_base64(str__base64) {\n      str__base64 = str__base64.split(\"_\").join(\"/\");\n      str__base64 = str__base64.split(\"-\").join(\"+\");\n      var str = window.atob(str__base64);\n      return str;\n    }\n  }, {\n    key: \"to_url\",\n    value: function to_url(preset) {\n      assert(preset instanceof Preset);\n      assert(preset.is_saved_preset);\n      var preset_string = PresetSerializer.serialize_preset(preset);\n\n      var preset_base64 = this._to_base64(preset_string);\n\n      var url_base = window.location.href.split(\"#\")[0];\n      var preset_id = preset.preset_id;\n      var name_encoded = encodeURIComponent(preset_id); // @ts-ignore\n\n      assert.warning(name !== name_encoded, {\n        name: name,\n        name_encoded: name_encoded\n      });\n      var link = url_base + \"#\" + name_encoded + \"/\" + preset_base64;\n      return link;\n    }\n  }, {\n    key: \"from_url\",\n    value: function from_url() {\n      var preset_url = window.location.href;\n      var pipe_data = preset_url.split(\"#\")[1];\n\n      if (!pipe_data) {\n        return null;\n      } // Old Clock Tab URL for fullscreen mode\n\n\n      if ([\"/fullscreen\", \"fullscreen\"].includes(pipe_data)) {\n        return null;\n      } // Not sure why some users have a Data URI appended to their URL\n\n\n      if (pipe_data.startsWith(\"data:image\")) {\n        return null;\n      }\n\n      pipe_data = pipe_data.split(\"/\").filter(Boolean)[1];\n\n      if (!pipe_data) {\n        return null;\n      }\n\n      try {\n        pipe_data = this._from_base64(pipe_data);\n      } catch (err) {\n        on_error(err);\n        return null;\n      }\n\n      var preset_data;\n\n      try {\n        preset_data = PresetSerializer.deserialize_preset(pipe_data);\n      } catch (err) {\n        on_error(err);\n        return null;\n      }\n\n      return preset_data;\n\n      function on_error(err) {\n        show_toast(\"Wrong URL. The URL could not be processed.\", {\n          is_error: true\n        });\n        track_error({\n          name: \"preset_url_parsing\",\n          value: pipe_data,\n          err: err\n        });\n        console.log(pipe_data);\n        console.error(err);\n      }\n    }\n  }]);\n\n  return LinkSerializer;\n}();","\"use strict\";\n\nimport { migrate_ancient_schema } from \"./migrations/001-ancient-schema\";\nimport { migrate_user_preset_ids_and_values } from \"./migrations/002-migrate-user-preset-ids-and-values\";\nimport { migrate_subapp_id } from \"./migrations/003-migrate-subapp-id\";\nimport { migrate_old_timer_tab_schema } from \"./migrations/004-migrate-old-timer-tab-schema\";\nimport { migrate_to_centralized_store } from \"./migrations/005-migrate-to-centralized-store\";\nimport { store } from \"../store\";\nimport assert from \"@brillout/assert\";\nexport { run_migrations };\n\nfunction run_migrations() {\n  if (typeof window === \"undefined\") {\n    return;\n  }\n\n  var migrators = [migrate_ancient_schema, migrate_user_preset_ids_and_values, migrate_subapp_id, migrate_old_timer_tab_schema, migrate_to_centralized_store];\n  var schema_version__curent = store.get_schema_version();\n  assert(schema_version__curent.constructor === Date);\n  migrators.forEach(function (migrator, i) {\n    var schema_version = migrator.schema_version;\n    assert(schema_version.constructor === Date);\n    assert(i === migrators.length - 1 || schema_version.getTime() < migrators[i + 1].schema_version.getTime());\n\n    if (schema_version__curent.getTime() < schema_version.getTime()) {\n      migrator();\n      store.set_schema_version(schema_version);\n    }\n  });\n}"],"sourceRoot":""}